[
  {
    "objectID": "src/specific-aims.html#sec-aims-rationale",
    "href": "src/specific-aims.html#sec-aims-rationale",
    "title": "2  Specific Aims",
    "section": "Rationale",
    "text": "Rationale\nAs the importance of causal inference becomes increasingly recognized in neuroscience, the need for technology enabling precise manipulation of neural variables becomes apparent. Feedback control is an important class of such manipulations for its ability to increase inference power by reducing response variability. Widely used throughout the engineering disciplines, it has had a significant impact through a variety of techniques (e.g., voltage clamp, dynamic clamp) on cellular neuroscience. However, feedback control also has great potential at the mesoscale/systems level, potentially enabling researchers to unambiguously infer the downstream effects of circuit/population-level neural activity.\nFor a number of reasons, though, this potential has not been widely realized. The main challenges to wider adoption do not appear to lie with available technology, as the requirements of feedback control are beginning to be met by the ever-improving computational power and stimulation/recording tools (such as optogenetics and large-scale neural recording) already available to neuroscientists. I posit that the main challenges to adoption rather include the complexity of implementing fast closed-loop experiments, the need to adapt the mature methods of control theory to the idiosyncratic constraints of systems neuroscience experiments, and the lack of established technical guidelines for applying feedback control to address complex scientific questions. The proposed work aims to begin to address these challenges, and thus strengthen the set of causal tools available to probe neural systems."
  },
  {
    "objectID": "src/specific-aims.html#aim-1-a-cloc-experiment-simulation-testbed",
    "href": "src/specific-aims.html#aim-1-a-cloc-experiment-simulation-testbed",
    "title": "2  Specific Aims",
    "section": "Aim 1: A CLOC experiment simulation testbed",
    "text": "Aim 1: A CLOC experiment simulation testbed\nOne significant obstacle to closed-loop optogenetic control (CLOC) experiments is the cost of acquiring and configuring compatible hardware-software systems. Moreover, the maintenance of animals or cell cultures inherent in lab experiments can slow the pace of developing novel techniques. In Aim 1, I attempt to address these obstacles by developing a simulation framework for easily prototyping CLOC experiments in silico, thus enabling faster, cheaper CLOC experiment design and method development. We demonstrate the software’s utility in different virtual experiments and provide it to the public as open-source software with thorough documentation."
  },
  {
    "objectID": "src/specific-aims.html#aim-2-multi-input-cloc",
    "href": "src/specific-aims.html#aim-2-multi-input-cloc",
    "title": "2  Specific Aims",
    "section": "Aim 2: Multi-input CLOC",
    "text": "Aim 2: Multi-input CLOC\nMulti-input CLOC—the simultaneous use of multiple light sources—is necessary for precise manipulation of neural systems, especially when bidirectional actuation (both excitatory and inhibitory opsins) is needed to maintain naturalistic activity levels. However, the basic control theory methods previously used in conjuction with CLOC do not take actuator constraints into account and are thus inadequate for multi-actuator (i.e., multi-light source) problems. The field of control theory provides elegant, powerful solutions to this class of problems, but applying them requires interdisciplinary expertise. In this aim I will translate more sophisticated model-based feedback control algorithms to the multi-input CLOC setting and demonstrate the advantages both of bidirectional actuation and these algorithmic improvements."
  },
  {
    "objectID": "src/specific-aims.html#aim-3-using-cloc-to-manipulate-latent-neural-dynamics",
    "href": "src/specific-aims.html#aim-3-using-cloc-to-manipulate-latent-neural-dynamics",
    "title": "2  Specific Aims",
    "section": "Aim 3: Using CLOC to manipulate latent neural dynamics",
    "text": "Aim 3: Using CLOC to manipulate latent neural dynamics\nTo our knowledge, CLOC has yet to be applied in answering complex systems neuroscience questions. In this aim, to pave the way for future in-vivo experiments that accomplish this, I propose to develop technical and conceptual guidelines as I control the latent dynamics of simulated neural populations. First, I will produce these virtual models by training recurrent spiking neural networks with state-of-the-art, biologically plausible methods—each differing in their degrees of brain-like architecture and training procedure complexity. I will then use the simulation testbed of Aim 1 to explore control quality varies with recording, stimulation, and control parameters and the complexity and size of the system—thus giving researchers a tentative idea of the relative importance of each factor of CLOC. I will test the hypothesis that low-dimensional dynamics can be manipulated with similarly low-dimensional, rather than per-neuron, actuation."
  },
  {
    "objectID": "src/background.html#sec-cl-neuro",
    "href": "src/background.html#sec-cl-neuro",
    "title": "3  Background",
    "section": "Closed-loop control in neuroscience",
    "text": "Closed-loop control in neuroscience\nMesoscale neuroscience—on the level of populations of neurons, rather than the whole brain or individual cells—is currently undergoing a revolution fueled by advances in neural manipulation (Adesnik and Abdeladim, 2021; Eriksson et al., 2022; Faini et al., 2021; Fenno et al., 2011; Roth, 2016; Sridharan et al., 2022; Vierock et al., 2021; Wiegert et al., 2017) and measurement (Göbel and Helmchen, 2007; Gutruf and Rogers, 2018; Kazemipour et al., 2019; Knöpfel and Song, 2019; Siegle et al., 2017; Steinmetz et al., 2021; Svoboda and Yasuda, 2006; Wu et al., 2020) technologies as well as data analysis methods (Berman et al., 2014; Maaten and Hinton, 2008; Mathis et al., 2018; Sani et al., 2021a; Schneider et al., 2022; Sporns, 2018). These have yielded unprecedented datasets (Juavinett et al., 2019; Scheffer et al., 2020) and insights into network activity and plasticity (Avitan and Stringer, 2022; Cowley et al., 2020; Jazayeri and Ostojic, 2021; Oby et al., 2019; Yang et al., 2021) Moreover, they enable novel experimental paradigms such as direct closed-loop control of neural activity (Bolus et al., 2021, 2018; Dutta et al., 2019; Grosenick et al., 2015; Krook-Magnuson et al., 2013; Kumar et al., 2013; Newman et al., 2015; Potter et al., 2014; Witt et al., 2013; Zhang et al., 2018). This closed-loop control of neural activity offers exciting prospects of intervention in processes that are too fast or unpredictable to control manually or with pre-defined stimulation, such as sensory information processing, motor planning, and oscillatory activity. Unlike other forms of closed-loop control using environmental/stimulus input (Tafazoli et al., 2020), behavioral output (Srinivasan et al., 2018) or neurofeedback training (Eriksson et al., 2022; Prsa et al., 2017), the direct control of neural activity itself provides more opportunities for revealing the downstream effects of that activity.\n\nTypes of closed-loop control\nClosed-loop control of neural activity can be implemented in an event-triggered sense (Dutta et al., 2019; Krook-Magnuson et al., 2013; Witt et al., 2013)—enabling the experimenter to respond to discrete events of interest, such as the arrival of a traveling wave (Davis et al., 2020) or sharp wave ripple (Buzsáki, 2015)—or in a feedback sense (Bolus et al., 2021, 2018; Newman et al., 2015; Zhang et al., 2018), driving the system towards a target or along a trajectory. The latter has multiple advantages over open-loop control (delivery of a pre-defined stimulus): by rejecting exogenous inputs, noise, and disturbances, it reduces variability across time and across trials, allowing for finer-scale inference. Additionally, it can compensate for model mismatch as it actively reduces error, whereas an open-loop stimulus is defined and limited by imperfect models. Moreover, whereas traditional perturbation methods often include lesioning (Vaidya et al., 2019), unnatural silencing, or extreme stimulation, feedback control poses a more naturalistic alternative, increasing generalizability. Clamping the activity of a population of neurons to their baseline, for example, effectively shuts down information flow from those neurons without departing from typical firing rates."
  },
  {
    "objectID": "src/background.html#various-scales-and-tools-for-closed-loop-control",
    "href": "src/background.html#various-scales-and-tools-for-closed-loop-control",
    "title": "3  Background",
    "section": "Various scales and tools for closed-loop control",
    "text": "Various scales and tools for closed-loop control\nClosed-loop control of neural activity can be performed at multiple scales and with different sets of tools. At the smallest, sub-neuron scale, feedback control has yielded decades of fruitful research in the form of tools such as the voltage clamp (Hodgkin et al., 1952) and dynamic clamp (Prinz et al., 2004; Sharp et al., 1993), controlling electrical properties of the cell membrane. The frontiers of this small-scale neuroscience often involve scaling up to many neurons and scaling down to subcellular structures such as dendrites, but multi-electrode, in-vivo, intracellular recording methods are challenging (Alegria et al., 2020; Davie et al., 2006; Engel, 2016; Peng et al., 2019; Wang et al., 2015). Optical tools—e.g., optogenetics and fluorescence microscopy—can circumvent the difficulties of working with electrodes at such small scales, but an optical approach is not yet feasible for this purpose. The obstacles lie mainly in recording technology: the kinetics of both voltage indicators (Wu et al., 2020) and intracellular calcium (Inoue, 2021) are too slow to capture phenomena faster than a typical action potential.\nBy contrast, the current state of technology is ripe for innovating closed-loop control methods at larger scales of neural activity, from single neurons to populations and circuits. Several promising combinations of recording and stimulation modalities are possible and still relatively novel: electrode recording with optogenetic stimulation (Bolus et al., 2021, 2018; Cardin et al., 2010; Newman et al., 2015), fluorescence microscopy with electrical stimulation (Wu et al., 2020), fluorescence microscopy with photostimulation (all-optical control) (Emiliani et al., 2015; Flytzanis et al., 2014; Hochbaum et al., 2014; Kishi et al., 2022; Zhang et al., 2018), and fMRI with optionally transcranial photostimulation (Chen et al., 2018; Lin et al., 2013). Each of these tool combinations has pros and cons in terms of spatial and temporal resolution, crosstalk (Packer et al., 2013), and degrees of freedom.\nA natural starting point for many neuroscientists is the first of these tool sets—electrode recording combined with optogenetics—since the two methods are so widely used, interfere little with each other (as long as metal electrodes are not directly illuminated (Cardin et al., 2010; Packer et al., 2013)), and allow for genetically targeted stimulation. I will henceforth refer to this combination as CLOC, following the convention established by previous works (Bolus et al., 2021, 2018)."
  },
  {
    "objectID": "src/background.html#sec-prev-work",
    "href": "src/background.html#sec-prev-work",
    "title": "3  Background",
    "section": "Previous work",
    "text": "Previous work\nThe proposed work builds on the work my lab and collaborators have done previously in developing CLOC. This includes pioneering work taking feedback control from the cellular to the network level by controlling population firing rates in vitro—first by Wagenaar et al. (2005), who reduce unnatural global bursting and conclude as a result that such bursting results from the lack of the exogenous input present in the live, awake cortex. Later, Newman et al. (2013) used the same proportional error-driven controller in a demonstration of user-friendly real-time electrophysiology software.\nThese error-free control methods later saw further development and the introduction of optogenetic actuation. In the first known demonstration of optogenetic feedback control, Newman et al. (2015) used bidirectional stimulation for fixed and slowly varying firing rate targets in vitro (Figure 3.1 (a)). The authors improved control methods by an introducing an integral term to the model-free controller and, in another first, demonstrated feedback control of firing rates in vivo by bringing CLOC to the anesthetized rat. Bolus et al. (2018) used PI control again, but developed a more principled approach to set estimation and control parameters and tracked dynamic firing rate trajectories down to a ~100-ms timescale (Figure 3.1 (b)).\nLater, in a direct precursor to the proposed work, Bolus et al. (2021) employed more sophisticated and scalable optimal feedback control methods that can be characterized as an adaptive linear quadratic regulator (LQR). Built on a state-space, linear dynamical system model, the controller estimates the latent state using Kalman filtering (Kalman, 1960) and calculates in real-time the optimal control input based on the current error. The authors enable adaptivity by estimating a second latent state, added to the first, that represents a slowly varying bias or disturbance to the system—important especially in awake animal experiments, where dynamic brain state changes contribute to high per-trial variability (Figure 3.1 (c)).\n\n\n\n\n\n\n(a)\n\n\n\n\n\n(b)\n\n\n\n\n\n\n\n(c)\n\n\n\nFigure 3.1: Previous CLOC experiments. (A) Figure 2 from Newman et al. (2015), demonstrating control clamping a cultured neuron to different firing rates. \\(U_C\\) refers to the control signal for channelrhodopsin2(H134R) (ChR2R), parametrizing 470-nm light delivery. \\(U_H\\) likewise parametrizes 590-nm light delivery to activate enhanced halorhodopsin-3.0 (eNpHR3.0). (B) Figure 2 from Bolus et al. (2018), outlining an in-vivo experiment setup, a control diagram showing how optical input is determined from the firing rate estimated in real time, and a strategy for tuning the controller. (C) Figure 4b from Bolus et al. (2021), showing how CLOC clamps the firing rate of a single thalamic neuron in the awake mouse over multiple trials, reducing response variability (as measured by the Fano factor)."
  },
  {
    "objectID": "src/background.html#unexplored-applications-for-network-level-control",
    "href": "src/background.html#unexplored-applications-for-network-level-control",
    "title": "3  Background",
    "section": "Unexplored applications for network-level control",
    "text": "Unexplored applications for network-level control\nWhile preliminary technological foundations for feedback control of neural activity have already been laid, CLOC has yet to be applied to network-level variables beyond population firing rates to further causal hypothesis testing.    Examples of these potential targets for control include the activity of different cell types (Joglekar et al., 2021; Lee et al., 2020; Martinez-Garcia et al., 2020; Mukamel and Ngai, 2019; Němec and Osten, 2020; Zeng, 2022); the type (Cole and Voytek, 2017; Cole and Voytek, 2019; Fabus et al., 2021), frequency (Saleem et al., 2017), amplitude (Saleem et al., 2017), spike coherence (Buffalo et al., 2011; Buschman et al., 2012) and interactions (Aru et al., 2015; Zhang et al., 2019) of different oscillatory patterns (Buzsáki and Draguhn, 2004); discrete phenomena such as bursts (Gerstner et al., 2014), sharp wave ripples (Buzsáki, 2015), oscillatory bursts (Akam and Kullmann, 2014; Karvat et al., 2020; Lundqvist et al., 2022; Lundqvist et al., 2016; Tal et al., 2020), traveling waves (Davis et al., 2020; Moldakarimov et al., 2018; Muller et al., 2018; Rule et al., 2018; Sato et al., 2012; Zhang et al., 2018), or sleep spindles (Fernandez and Lüthi, 2020); and latent states describing neural dynamics (Churchland et al., 2012; Cunningham and Yu, 2014; Gallego et al., 2017; Kaufman et al., 2014; Peixoto et al., 2021; Shenoy et al., 2013; Shenoy and Kao, 2021; Vyas et al., 2020), including those most predictive of behavior (Hurwitz et al., 2021; Sani et al., 2021a, 2021b). In the proposed work, I focus on the latter for their success in generating computational hypotheses for brain function and in predicting behavior. In the following chapters, I describe plans to move towards in-vivo control of latent dynamics by developing CLOC infrastructure and algorithms and finally performing simulations and analysis in silico.\n\n\n\n\n\n\n\nAdesnik H, Abdeladim L. 2021. Probing neural codes with two-photon holographic optogenetics. Nature Neuroscience 24:1356–1366. doi:10.1038/s41593-021-00902-9\n\n\nAkam T, Kullmann DM. 2014. Oscillatory multiplexing of population codes for selective communication in the mammalian brain. Nature Reviews Neuroscience 15:111–122. doi:10.1038/nrn3668\n\n\nAlegria A, Joshi A, O’Brien J, Kodandaramaiah SB. 2020. Single neuron recording: Progress towards high-throughput analysis. Bioelectronics in Medicine 3:33–36. doi:10.2217/bem-2020-0011\n\n\nAru J, Aru J, Priesemann V, Wibral M, Lana L, Pipa G, Singer W, Vicente R. 2015. Untangling cross-frequency coupling in neuroscience. Current Opinion in Neurobiology 31:51–61. doi:10.1016/j.conb.2014.08.002\n\n\nAvitan L, Stringer C. 2022. Not so spontaneous: Multi-dimensional representations of behaviors and context in sensory areas. Neuron. doi:10.1016/j.neuron.2022.06.019\n\n\nBerman GJ, Choi DM, Bialek W, Shaevitz JW. 2014. Mapping the stereotyped behaviour of freely moving fruit flies. Journal of The Royal Society Interface 11:20140672. doi:10.1098/rsif.2014.0672\n\n\nBolus MF, Willats AA, Rozell CJ, Stanley GB. 2021. State-space optimal feedback control of optogenetically driven neural activity. Journal of neural engineering 18:036006. doi:10.1101/2020.06.25.171785\n\n\nBolus MF, Willats AA, Whitmire CJ, Rozell CJ, Stanley GB. 2018. Design strategies for dynamic closed-loop optogenetic neurocontrol in vivo. Journal of Neural Engineering 15:026011. doi:10.1088/1741-2552/aaa506\n\n\nBuffalo EA, Fries P, Landman R, Buschman TJ, Desimone R. 2011. Laminar differences in gamma and alpha coherence in the ventral stream. Proceedings of the National Academy of Sciences of the United States of America 108:11262–11267. doi:10.1073/pnas.1011284108\n\n\nBuschman TJ, Denovellis EL, Diogo C, Bullock D, Miller EK. 2012. Synchronous Oscillatory Neural Ensembles for Rules in the Prefrontal Cortex. Neuron 76:838–846. doi:10.1016/j.neuron.2012.09.029\n\n\nBuzsáki G. 2015. Hippocampal sharp wave-ripple: A cognitive biomarker for episodic memory and planning. Hippocampus 25:1073–1188. doi:10.1002/hipo.22488\n\n\nBuzsáki G, Draguhn A. 2004. Neuronal oscillations in cortical networks. Science 304:1926–1929. doi:10.1126/science.1099745\n\n\nCardin JA, Carlén M, Meletis K, Knoblich U, Zhang F, Deisseroth K, Tsai LH, Moore CI. 2010. Targeted optogenetic stimulation and recording of neurons in vivo using cell-type-specific expression of Channelrhodopsin-2. Nature Protocols 5:247–254. doi:10.1038/nprot.2009.228\n\n\nChen S, Weitemier AZ, Zeng X, He L, Wang X, Tao Y, Huang AJY, Hashimotodani Y, Kano M, Iwasaki H, Parajuli LK, Okabe S, Loong Teh DB, All AH, Tsutsui-Kimura I, Tanaka KF, Liu X, McHugh TJ. 2018. Near-infrared deep brain stimulation via upconversion nanoparticlemediated optogenetics. Science 359:679–684. doi:10.1126/science.aaq1144\n\n\nChurchland MM, Cunningham JP, Kaufman MT, Foster JD, Nuyujukian P, Ryu SI, Shenoy KV, Shenoy KV. 2012. Neural population dynamics during reaching. Nature 487:51–56. doi:10.1038/nature11129\n\n\nCole SR, Voytek B. 2017. Brain Oscillations and the Importance of Waveform Shape. Trends in Cognitive Sciences 21:137–149. doi:10.1016/j.tics.2016.12.008\n\n\nCole S, Voytek B. 2019. Cycle-by-cycle analysis of neural oscillations. Journal of Neurophysiology 122:849–861. doi:10.1152/JN.00273.2019\n\n\nCowley BR, Snyder AC, Acar K, Williamson RC, Yu BM, Smith MA. 2020. Slow Drift of Neural Activity as a Signature of Impulsivity in Macaque Visual and Prefrontal Cortex. Neuron 108:551–567.e8. doi:10.1016/j.neuron.2020.07.021\n\n\nCunningham JP, Yu BM. 2014. Dimensionality reduction for large-scale neural recordings. Nature neuroscience 17:1500–9. doi:10.1038/nn.3776\n\n\nDavie JT, Kole MHP, Letzkus JJ, Rancz EA, Spruston N, Stuart GJ, Häusser M. 2006. Dendritic patch-clamp recording. Nature Protocols 1:1235–1247. doi:10.1038/nprot.2006.164\n\n\nDavis ZW, Muller L, Martinez-Trujillo J, Sejnowski T, Reynolds JH. 2020. Spontaneous travelling cortical waves gate perception in behaving primates. Nature 587:432–436. doi:10.1038/s41586-020-2802-y\n\n\nDutta S, Ackermann E, Kemere C. 2019. Analysis of an open source, closed-loop, realtime system for hippocampal sharp-wave ripple disruption. Journal of Neural Engineering 16:016009. doi:10.1088/1741-2552/aae90e\n\n\nEmiliani V, Cohen AE, Deisseroth K, Häusser M. 2015. All-optical interrogation of neural circuits. Journal of Neuroscience 35:13917–13926. doi:10.1523/JNEUROSCI.2916-15.2015\n\n\nEngel D. 2016. Subcellular patch-clamp recordings from the somatodendritic domain of nigral dopamine neurons. Journal of Visualized Experiments 2016:e54601. doi:10.3791/54601\n\n\nEriksson D, Schneider A, Thirumalai A, Alyahyay M, de la Crompe B, Sharma K, Ruther P, Diester I. 2022. Multichannel optogenetics combined with laminar recordings for ultra-controlled neuronal interrogation. Nature Communications 13:985. doi:10.1038/s41467-022-28629-6\n\n\nFabus MS, Quinn AJ, Warnaby CE, Woolrich MW. 2021. Automatic decomposition of electrophysiological data into distinct nonsinusoidal oscillatory modes. Journal of Neurophysiology 126:1670–1684. doi:10.1152/jn.00315.2021\n\n\nFaini G, Molinier C, Telliez C, Tourain C, Forget BC, Ronzitti E, Emiliani V. 2021. Ultrafast Light Targeting for High-Throughput Precise Control of Neuronal Networks. bioRxiv 2021.06.14.448315. doi:10.1101/2021.06.14.448315\n\n\nFenno L, Yizhar O, Deisseroth K. 2011. The development and application of optogenetics. Annual Review of Neuroscience 34:389–412. doi:10.1146/annurev-neuro-061010-113817\n\n\nFernandez LMJ, Lüthi A. 2020. Sleep Spindles: Mechanisms and Functions. Physiological Reviews 100:805–868. doi:10.1152/physrev.00042.2018\n\n\nFlytzanis NC, Bedbrook CN, Chiu H, Engqvist MKM, Xiao C, Chan KY, Sternberg PW, Arnold FH, Gradinaru V. 2014. Archaerhodopsin variants with enhanced voltage-sensitive fluorescence in mammalian and Caenorhabditis elegans neurons. Nature Communications 5:4894. doi:10.1038/ncomms5894\n\n\nGallego JA, Perich MG, Miller LE, Solla SA. 2017. Neural Manifolds for the Control of Movement. Neuron 94:978–984. doi:10.1016/j.neuron.2017.05.025\n\n\nGerstner W, Kistler WM, Naud R, Paninski L. 2014. Neuronal dynamics: From single neurons to networks and models of cognition, Neuronal Dynamics: From Single Neurons to Networks and Models of Cognition. Cambridge University Press. doi:10.1017/CBO9781107447615\n\n\nGöbel W, Helmchen F. 2007. In Vivo Calcium Imaging of Neural Network Function. Physiology 22:358–365. doi:10.1152/physiol.00032.2007\n\n\nGrosenick L, Marshel JH, Deisseroth K. 2015. Review Closed-Loop and Activity-Guided Optogenetic Control. Neuron 86:106–139. doi:10.1016/j.neuron.2015.03.034\n\n\nGutruf P, Rogers JA. 2018. Implantable, wireless device platforms for neuroscience research. Current Opinion in Neurobiology, Neurotechnologies 50:42–49. doi:10.1016/j.conb.2017.12.007\n\n\nHochbaum DR, Zhao Y, Farhi SL, Klapoetke N, Werley CA, Kapoor V, Zou P, Kralj JM, MacLaurin D, Smedemark-Margulies N, Saulnier JL, Boulting GL, Straub C, Cho YK, Melkonian M, Wong GKS, Harrison DJ, Murthy VN, Sabatini BL, Boyden ES, Campbell RE, Cohen AE. 2014. All-optical electrophysiology in mammalian neurons using engineered microbial rhodopsins. Nature Methods 11:825–833. doi:10.1038/NMETH.3000\n\n\nHodgkin AL, Huxley AF, Katz B. 1952. Measurement of current-voltage relations in the membrane of the giant axon of Loligo. The Journal of Physiology 116:424–448.\n\n\nHurwitz C, Srivastava A, Xu K, Jude J, Perich MG, Miller LE, Hennig MH. 2021. Targeted Neural Dynamical ModelingAdvances in Neural Information Processing Systems. pp. 29379–29392.\n\n\nInoue M. 2021. Genetically encoded calcium indicators to probe complex brain circuit dynamics in vivo. Neuroscience Research 169:2–8. doi:10.1016/j.neures.2020.05.013\n\n\nJazayeri M, Ostojic S. 2021. Interpreting neural computations by examining intrinsic and embedding dimensionality of neural activity. Current Opinion in Neurobiology 70:113–120. doi:10.1016/j.conb.2021.08.002\n\n\nJoglekar A, Prjibelski A, Mahfouz A, Collier P, Lin S, Schlusche AK, Marrocco J, Williams SR, Haase B, Hayes A, Chew JG, Weisenfeld NI, Wong MY, Stein AN, Hardwick SA, Hunt T, Wang Q, Dieterich C, Bent Z, Fedrigo O, Sloan SA, Risso D, Jarvis ED, Flicek P, Luo W, Pitt GS, Frankish A, Smit AB, Ross ME, Tilgner HU. 2021. A spatially resolved brain region- and cell type-specific isoform atlas of the postnatal mouse brain. Nature Communications 12:463. doi:10.1038/s41467-020-20343-5\n\n\nJuavinett AL, Bekheet G, Churchland AK. 2019. Chronically implanted Neuropixels probes enable high-yield recordings in freely moving mice. eLife 8:e47188. doi:10.7554/eLife.47188\n\n\nKalman RE. 1960. A new approach to linear filtering and prediction problems. Journal of Fluids Engineering, Transactions of the ASME 82:35–45. doi:10.1115/1.3662552\n\n\nKarvat G, Schneider A, Alyahyay M, Steenbergen F, Tangermann M, Diester I. 2020. Real-time detection of neural oscillation bursts allows behaviourally relevant neurofeedback. Communications Biology 3:1–10. doi:10.1038/s42003-020-0801-z\n\n\nKaufman MT, Churchland MM, Ryu SI, Shenoy KV. 2014. Cortical activity in the null space: Permitting preparation without movement. Nature Neuroscience 17:440–448. doi:10.1038/nn.3643\n\n\nKazemipour A, Novak O, Flickinger D, Marvin JS, Abdelfattah AS, King J, Borden PM, Kim JJ, Al-Abdullatif SH, Deal PE, Miller EW, Schreiter ER, Druckmann S, Svoboda K, Looger LL, Podgorski K. 2019. Kilohertz frame-rate two-photon tomography. Nature Methods 16:778–786. doi:10.1038/s41592-019-0493-9\n\n\nKishi KE, Kim YS, Fukuda M, Inoue M, Kusakizako T, Wang PY, Ramakrishnan C, Byrne EFX, Thadhani E, Paggi JM, Matsui TE, Yamashita K, Nagata T, Konno M, Quirin S, Lo M, Benster T, Uemura T, Liu K, Shibata M, Nomura N, Iwata S, Nureki O, Dror RO, Inoue K, Deisseroth K, Kato HE. 2022. Structural basis for channel conduction in the pump-like channelrhodopsin ChRmine. Cell 185:672–689.e23. doi:10.1016/j.cell.2022.01.007\n\n\nKnöpfel T, Song C. 2019. Optical voltage imaging in neurons: Moving from technology development to practical tool. Nature Reviews Neuroscience 20:719–727. doi:10.1038/s41583-019-0231-4\n\n\nKrook-Magnuson E, Armstrong C, Oijala M, Soltesz I. 2013. On-demand optogenetic control of spontaneous seizures in temporal lobe epilepsy. Nature Communications 4:1–8. doi:10.1038/ncomms2376\n\n\nKumar A, Vlachos I, Aertsen A, Boucsein C. 2013. Challenges of understanding brain function by selective modulation of neuronal subpopulations. Trends in Neurosciences 36:579–586. doi:10.1016/j.tins.2013.06.005\n\n\nLee C, Lavoie A, Liu J, Chen SX, Liu B. 2020. Light Up the Brain: The Application of Optogenetics in Cell-Type Specific Dissection of Mouse Brain Circuits. Frontiers in Neural Circuits 14.\n\n\nLin JY, Knutsen PM, Muller A, Kleinfeld D, Tsien RY. 2013. ReaChR: A red-shifted variant of channelrhodopsin enables deep transcranial optogenetic excitation. Nature Neuroscience 16:1499–1508. doi:10.1038/nn.3502\n\n\nLundqvist M, Rose J, Brincat SL, Warden MR, Buschman TJ, Herman P, Miller EK. 2022. Reduced variability of bursting activity during working memory. Scientific Reports 12:15050. doi:10.1038/s41598-022-18577-y\n\n\nLundqvist M, Rose J, Herman P, Brincat SLL, Buschman TJJ, Miller EKK. 2016. Gamma and Beta Bursts Underlie Working Memory. Neuron 90:152–164. doi:10.1016/j.neuron.2016.02.028\n\n\nMaaten L van der, Hinton G. 2008. Visualizing Data using t-SNE. Journal of Machine Learning Research 9:2579–2605.\n\n\nMartinez-Garcia RI, Voelcker B, Zaltsman JB, Patrick SL, Stevens TR, Connors BW, Cruikshank SJ. 2020. Two dynamically distinct circuits drive inhibition in the sensory thalamus. Nature 583:813–818. doi:10.1038/s41586-020-2512-5\n\n\nMathis A, Mamidanna P, Cury KM, Abe T, Murthy VN, Mathis MW, Bethge M. 2018. DeepLabCut: Markerless pose estimation of user-defined body parts with deep learning. Nature Neuroscience 21:1281–1289. doi:10.1038/s41593-018-0209-y\n\n\nMoldakarimov S, Bazhenov M, Feldman DE, Sejnowski TJ. 2018. Structured networks support sparse traveling waves in rodent somatosensory cortex. Proceedings of the National Academy of Sciences of the United States of America 115:5277–5282. doi:10.1073/pnas.1710202115\n\n\nMukamel EA, Ngai J. 2019. Perspectives on defining cell types in the brain. Current Opinion in Neurobiology, Neuronal Identity 56:61–68. doi:10.1016/j.conb.2018.11.007\n\n\nMuller L, Chavane F, Reynolds J, Sejnowski TJ. 2018. Cortical travelling waves: Mechanisms and computational principles. Nature Reviews Neuroscience 19:255–268. doi:10.1038/nrn.2018.20\n\n\nNěmec P, Osten P. 2020. The evolution of brain structure captured in stereotyped cell count and cell type distributions. Current Opinion in Neurobiology, Neurobiology of Behavior 60:176–183. doi:10.1016/j.conb.2019.12.005\n\n\nNewman JP, Fong MF, Millard DC, Whitmire CJ, Stanley GB, Potter SM. 2015. Optogenetic feedback control of neural activity. eLife. doi:10.7554/eLife.07192\n\n\nNewman J, Zeller-Townson R, Fong M, Arcot Desai S, Gross R, Potter S. 2013. Closed-Loop, Multichannel Experimentation Using the Open-Source NeuroRighter Electrophysiology Platform. Frontiers in Neural Circuits 6.\n\n\nOby ER, Golub MD, Hennig JA, Degenhart AD, Tyler-Kabara EC, Yu BM, Chase SM, Batista AP. 2019. New neural activity patterns emerge with long-term learning. Proceedings of the National Academy of Sciences 116:15210–15215. doi:10.1073/pnas.1820296116\n\n\nPacker AM, Roska B, Häuser M. 2013. Targeting neurons and photons for optogenetics. Nature Neuroscience 16:805–815. doi:10.1038/nn.3427\n\n\nPeixoto D, Verhein JR, Kiani R, Kao JC, Nuyujukian P, Chandrasekaran C, Brown J, Fong S, Ryu SI, Shenoy KV, Newsome WT. 2021. Decoding and perturbing decision states in real time. Nature 591:604–609. doi:10.1038/s41586-020-03181-9\n\n\nPeng Y, Mittermaier FX, Planert H, Schneider UC, Alle H, Geiger JRP. 2019. High-throughput microcircuit analysis of individual human brains through next-generation multineuron patch-clamp. eLife 8:e48178. doi:10.7554/eLife.48178\n\n\nPotter SM, El Hady A, Fetz EE. 2014. Closed-loop neuroscience and neuroengineering. Frontiers in Neural Circuits 0:115. doi:10.3389/FNCIR.2014.00115\n\n\nPrinz AA, Abbott LF, Marder E. 2004. The dynamic clamp comes of age. Trends in Neurosciences 27:218–224. doi:10.1016/j.tins.2004.02.004\n\n\nPrsa M, Galiñanes GL, Huber D. 2017. Rapid Integration of Artificial Sensory Feedback during Operant Conditioning of Motor Cortex Neurons. Neuron 93:929–939.e6. doi:10.1016/j.neuron.2017.01.023\n\n\nRoth BL. 2016. DREADDs for Neuroscientists. Neuron 89:683–694. doi:10.1016/j.neuron.2016.01.040\n\n\nRule ME, Vargas-Irwin C, Donoghue JP, Truccolo W. 2018. Phase reorganization leads to transient \\(\\beta\\)-LFP spatial wave patterns in motor cortex during steady-state movement preparation. Journal of Neurophysiology 119:2212–2228. doi:10.1152/jn.00525.2017\n\n\nSaleem AB, Lien AD, Krumin M, Haider B, Rosón MR, Ayaz A, Reinhold K, Busse L, Carandini M, Harris KD, Carandini M. 2017. Subcortical Source and Modulation of the Narrowband Gamma Oscillation in Mouse Visual Cortex. Neuron 93:315–322. doi:10.1016/j.neuron.2016.12.028\n\n\nSani OG, Abbaspourazad H, Wong YT, Pesaran B, Shanechi MM. 2021a. Modeling behaviorally relevant neural dynamics enabled by preferential subspace identification. Nature Neuroscience 24:140–149. doi:10.1038/s41593-020-00733-0\n\n\nSani OG, Pesaran B, Shanechi MM, Hsieh M. 2021b. Where is all the nonlinearity: Flexible nonlinear modeling of behaviorally relevant neural dynamics using recurrent neural networks. bioRxiv 2021.09.03.458628. doi:10.1101/2021.09.03.458628\n\n\nSato TK, Nauhaus I, Carandini M. 2012. Traveling Waves in Visual Cortex. Neuron 75:218–229. doi:10.1016/j.neuron.2012.06.029\n\n\nScheffer LK, Xu CS, Januszewski M, Lu Z, Takemura S, Hayworth KJ, Huang GB, Shinomiya K, Maitlin-Shepard J, Berg S, Clements J, Hubbard PM, Katz WT, Umayam L, Zhao T, Ackerman D, Blakely T, Bogovic J, Dolafi T, Kainmueller D, Kawase T, Khairy KA, Leavitt L, Li PH, Lindsey L, Neubarth N, Olbris DJ, Otsuna H, Trautman ET, Ito M, Bates AS, Goldammer J, Wolff T, Svirskas R, Schlegel P, Neace E, Knecht CJ, Alvarado CX, Bailey DA, Ballinger S, Borycz JA, Canino BS, Cheatham N, Cook M, Dreher M, Duclos O, Eubanks B, Fairbanks K, Finley S, Forknall N, Francis A, Hopkins GP, Joyce EM, Kim S, Kirk NA, Kovalyak J, Lauchie SA, Lohff A, Maldonado C, Manley EA, McLin S, Mooney C, Ndama M, Ogundeyi O, Okeoma N, Ordish C, Padilla N, Patrick CM, Paterson T, Phillips EE, Phillips EM, Rampally N, Ribeiro C, Robertson MK, Rymer JT, Ryan SM, Sammons M, Scott AK, Scott AL, Shinomiya A, Smith C, Smith K, Smith NL, Sobeski MA, Suleiman A, Swift J, Takemura S, Talebi I, Tarnogorska D, Tenshaw E, Tokhi T, Walsh JJ, Yang T, Horne JA, Li F, Parekh R, Rivlin PK, Jayaraman V, Costa M, Jefferis GS, Ito K, Saalfeld S, George R, Meinertzhagen IA, Rubin GM, Hess HF, Jain V, Plaza SM. 2020. A connectome and analysis of the adult Drosophila central brain. eLife 9:e57443. doi:10.7554/eLife.57443\n\n\nSchneider S, Lee JH, Mathis MW. 2022. Learnable latent embeddings for joint behavioral and neural analysis. doi:10.48550/arXiv.2204.00673\n\n\nSharp AA, O’Neil MB, Abbott LF, Marder E. 1993. The dynamic clamp: Artificial conductances in biological neurons. Trends in Neurosciences 16:389–394. doi:10.1016/0166-2236(93)90004-6\n\n\nShenoy KV, Kao JC. 2021. Measurement, manipulation and modeling of brain-wide neural population dynamics. Nature Communications 12:1–5. doi:10.1038/s41467-020-20371-1\n\n\nShenoy KV, Sahani M, Churchland MM. 2013. Cortical Control of Arm Movements: A Dynamical Systems Perspective. Annual Review of Neuroscience 36:337–359. doi:10.1146/annurev-neuro-062111-150509\n\n\nSiegle JH, López AC, Patel YA, Abramov K, Ohayon S, Voigts J. 2017. Open Ephys: An open-source, plugin-based platform for multichannel electrophysiology. Journal of Neural Engineering 14:045003. doi:10.1088/1741-2552/aa5eea\n\n\nSporns O. 2018. Graph theory methods: Applications in brain networks. Dialogues in Clinical Neuroscience 20:111–121. doi:10.31887/DCNS.2018.20.2/osporns\n\n\nSridharan S, Gajowa MA, Ogando MB, Jagadisan UK, Abdeladim L, Sadahiro M, Bounds HA, Hendricks WD, Turney TS, Tayler I, Gopakumar K, Oldenburg IA, Brohawn SG, Adesnik H. 2022. High-performance microbial opsins for spatially and temporally precise perturbations of large neuronal networks. Neuron 110:1139–1155.e6. doi:10.1016/j.neuron.2022.01.008\n\n\nSrinivasan SS, Maimon BE, Diaz M, Song H, Herr HM. 2018. Closed-loop functional optogenetic stimulation. Nature Communications 9:1–10. doi:10.1038/s41467-018-07721-w\n\n\nSteinmetz NA, Aydin C, Lebedeva A, Okun M, Pachitariu M, Bauza M, Beau M, Bhagat J, Böhm C, Broux M, Chen S, Colonell J, Gardner RJ, Karsh B, Kloosterman F, Kostadinov D, Mora-Lopez C, O’Callaghan J, Park J, Putzeys J, Sauerbrei B, van Daal RJJ, Vollan AZ, Wang S, Welkenhuysen M, Ye Z, Dudman JT, Dutta B, Hantman AW, Harris KD, Lee AK, Moser EI, O’Keefe J, Renart A, Svoboda K, Häusser M, Haesler S, Carandini M, Harris TD. 2021. Neuropixels 2.0: A miniaturized high-density probe for stable, long-term brain recordings. Science 372. doi:10.1126/science.abf4588\n\n\nSvoboda K, Yasuda R. 2006. Principles of Two-Photon Excitation Microscopy and Its Applications to Neuroscience. Neuron 50:823–839. doi:10.1016/j.neuron.2006.05.019\n\n\nTafazoli S, MacDowell CJ, Che Z, Letai KC, Steinhardt CR, Buschman TJ. 2020. Learning to control the brain through adaptive closed-loop patterned stimulation. Journal of Neural Engineering 17:056007. doi:10.1088/1741-2552/abb860\n\n\nTal I, Neymotin S, Bickel S, Lakatos P, Schroeder CE. 2020. Oscillatory Bursting as a Mechanism for Temporal Coupling and Information Coding. Frontiers in Computational Neuroscience 14.\n\n\nVaidya AR, Pujara MS, Petrides M, Murray EA, Fellows LK. 2019. Lesion Studies in Contemporary Neuroscience. Trends in Cognitive Sciences 23:653–671. doi:10.1016/j.tics.2019.05.009\n\n\nVierock J, Rodriguez-Rozada S, Dieter A, Pieper F, Sims R, Tenedini F, Bergs ACF, Bendifallah I, Zhou F, Zeitzschel N, Ahlbeck J, Augustin S, Sauter K, Papagiakoumou E, Gottschalk A, Soba P, Emiliani V, Engel AK, Hegemann P, Wiegert JS. 2021. BiPOLES is an optogenetic tool developed for bidirectional dual-color control of neurons. Nature Communications 12:1–20. doi:10.1038/s41467-021-24759-5\n\n\nVyas S, Golub MD, Sussillo D, Shenoy KV. 2020. Computation through Neural Population Dynamics. Annual Review of Neuroscience 43:249–275. doi:10.1146/annurev-neuro-092619-094115\n\n\nWagenaar DA, Madhavan R, Pine J, Potter SM. 2005. Controlling bursting in cortical cultures with closed-loop multi-electrode stimulation. Journal of Neuroscience 25:680–688. doi:10.1523/JNEUROSCI.4209-04.2005\n\n\nWang G, Wyskiel DR, Yang W, Wang Y, Milbern LC, Lalanne T, Jiang X, Shen Y, Sun QQ, Zhu JJ. 2015. An optogenetics- and imaging-assisted simultaneous multiple patch-clamp recording system for decoding complex neural circuits. Nature Protocols 10:397–412. doi:10.1038/nprot.2015.019\n\n\nWiegert JS, Mahn M, Prigge M, Printz Y, Yizhar O. 2017. Silencing Neurons: Tools, Applications, and Experimental Constraints. Neuron 95:504–529. doi:10.1016/j.neuron.2017.06.050\n\n\nWitt A, Palmigiano A, Neef A, El Hady A, Wolf F, Battaglia D. 2013. Controlling the oscillation phase through precisely timed closed-loop optogenetic stimulation: A computational study. Frontiers in Neural Circuits 7:1–17. doi:10.3389/fncir.2013.00049\n\n\nWu J, Liang Y, Chen S, Hsu CL, Chavarha M, Evans SW, Shi D, Lin MZ, Tsia KK, Ji N. 2020. Kilohertz two-photon fluorescence microscopy imaging of neural activity in vivo. Nature Methods 17:287–290. doi:10.1038/s41592-020-0762-7\n\n\nYang Y, Qiao S, Sani OG, Sedillo JI, Ferrentino B, Pesaran B, Shanechi MM. 2021. Modelling and prediction of the dynamic responses of large-scale brain networks during direct electrical stimulation. Nature Biomedical Engineering 5:324–345. doi:10.1038/s41551-020-00666-w\n\n\nZeng H. 2022. What is a cell type and how to define it? Cell 185:2739–2755. doi:10.1016/j.cell.2022.06.031\n\n\nZhang L, Lee J, Rozell C, Singer AC. 2019. Sub-second dynamics of theta-gamma coupling in hippocampal CA1. eLife 8. doi:10.7554/eLife.44320\n\n\nZhang Z, Russell LE, Packer AM, Gauld OM, Häusser M. 2018. Closed-loop all-optical interrogation of neural circuits in vivo. Nature Methods 15:1037–1040. doi:10.1038/s41592-018-0183-z"
  },
  {
    "objectID": "src/aim1.html#rationale",
    "href": "src/aim1.html#rationale",
    "title": "4  Aim 1 - A CLOC simulation testbed",
    "section": "Rationale",
    "text": "Rationale\nCLOC experiments are difficult and costly. This can be a barrier to entry for neuroscientists that find CLOC’s advantages attractive. Their lab might lack the funds or time to invest in hardware and software infrastructure. Or, they may possess the resources but do not want to spend them without some assurance that their proposed experiment would be fruitful. Finally, when the proposed experiment requires signal processing/control method development, iterating on designs in-vivo may be cumbersome, given the additional cost of animal care and training. These factors make CLOC experiments risky, especially since it is often hard to predict whether a proposed experiment will succeed.\nHowever, these costs and risks can be mitigated through in-silico prototyping. Given a reliable model of the system of interest, one can simulate a proposed experiment, assessing the effectiveness of a given setup. Alternate models can be tested to assess robustness of the given method to unknown model properties, or a single method can be validated on a variety of models to determine its general applicability. This strategy not only allows for a researcher to evaluate and optimize methods before committing significant resources to them, but also accelerates the development cycle.\n\nInnovation\nFor these reasons, I have developed Cleo: Closed Loop, Electrophysiology, and Optogenetics experiment simulation testbed. Unlike existing software, Cleo simultaneously provides a high-level interface to fast and flexible neural network simulations; easy, model-independent injection of electrode recording and optogenetic perturbations; and a real-time, closed-loop processing module capable of modeling communication and processing delays inherent in real experiments. I thus provide a low-cost environment to design and develop CLOC methods, as well as for researchers to see if CLOC may serve their research agenda."
  },
  {
    "objectID": "src/aim1.html#approach",
    "href": "src/aim1.html#approach",
    "title": "4  Aim 1 - A CLOC simulation testbed",
    "section": "Approach",
    "text": "Approach\n\nGuiding principles\nTwo factors drove our choice of recording and stimulation models to integrate into Cleo. First, because a main purpose of Cleo is to enable prototyping of experiments, we focused on models at the level of the parameters an experimenter is able to alter—this led us to choose models embeddedi n physical, 3D space. Second, we assumed that highly realistic models of individual neurons are not needed to capture most mesoscale-level phenomena. Accordingly, Cleo was developed with the intention of using point neurons models, rather than multi-compartment neuron models with realistic morphologies.\nIn addition to our modeling priorities, the goals of usability, flexibility, and extensibility guided our choices in software dependencies and infrastructure. Ease of use is important to make Cleo as accessible as possible to researchers with varied backgrounds, and motivated Cleo’s modular design, which allows users to add different recording or stimulation devices with little or no modification to the underlying network model. Flexibility in the underlying simulator, in addition to enabling compatibility with a wide variety of models, is necessary for arbitrarily interacting with the simulation in a closed-loop fashion. Finally, extensibility is important for the testbed to remain relevant under changing needs in the future, allowing for new functionality to be easily added in a “plug-in,” modular architecture.\n\n\nClosed-loop simulation architecture\n\n\n\nFigure 4.1: A conceptual diagram of Cleo’s functionality. Cleo wraps a Brian network model, injects stimulation and recording devices, and interfaces with the network in real time through a simulated “I/O processor”.\n\n\nWe chose Brian 2 (Stimberg et al., 2019) as the spiking neural network simulator to build Cleo around. Brian has the advantages of being flexible and intuitive, where models are defined with user-provided mathematical equations. Moreover, it is written in Python, an open-source, intuitive language (Bogdanchikov et al., 2013) widely used in computational neuroscience (Davison et al., 2009; Muller et al., 2015). Users do not need to use any other languages to use Brian. Brian is also relatively fast (especially since it is developed primarily for point neuron simulations), as shown in benchmarks (Stimberg et al., 2019).\nCleo provides three modules—recording, stimulation, and closed-loop processing—for integration with an existing Brian model (see Figure 4.1). Cleo’s functionality centers around a CLSimulator object that orchestrates the interactions between these three modules and the Brian simulation by injecting devices, running the simulation, and communicating with an IOProcessor object at each time step. The IOProcessor receives recorder measurements according to a specified sampling rate and returns any updates to stimulator devices. To simulate the effects of latency in closed-loop control, Cleo provides a LatencyIOProcessor class which stores control signals in a buffer to later deliver them after an arbitrary delay. \n\n\n\nElectrode recording\n\nBecause we have prioritized point neuron simulations, the electrode functionality currently implemented in Cleo does not rely on raw extracellular potentials, which can only be computed from multi-compartment neurons (Buzsáki et al., 2012; Pettersen et al., 2012). This biophysical forward modeling approach has been taken in other software (Hagen et al., 2018; Parasuram et al., 2016; Thornton et al., 2019; Tomsett et al., 2015). To approximate sorted and multi-spike recording without filtering and thresholding of extracellular potentials, Cleo simply takes ground-truth spikes and stochastically determines which to report with probability inversely proportional to distance to the electrode (Holt and Koch, 1999; Nason et al., 2020) (see Figure 4.2).\n\n\n\n\n\n\n\nFigure 4.2: Illustration of LFP and spiking from Cleo’s electrophysiology module. (A) The probabilistic spike detection model. All spikes within the 100% detection radius, 50% of spikes at the 50% detection radius, and none of those outside the threshold radius are recorded. The detection probability decays with 1/r. (B) An example plot generated by Cleo showing the positions of neurons and electrode contacts. (C) Randomly generated spikes for the neurons shown in B. Top: the sorted spike signal, which gives the ground truth source neuron for every spike as a perfect proxy for spike sorting. Bottom: multi-unit spikes, where spikes are reported on every channel they are detected on, regardless of the source neuron. (D) The TKLFP signal generated from the spikes in C for each channel. Y-axis units are not shown.\n\n\n\nIn order to approximate cortical LFP without recurring to morphological neurons and biophysical forward modeling, we implemented the kernel LFP approximation from (Telenczuk et al., 2020), which we term TKLFP (Teleńczuk kernel LFP). This method approximates the per-spike contribution to LFP (termed uLFP: unitary LFP) with a delayed Gaussian function, where amplitude and delay depend on the position of the neuron relative to the electrode.  This implementation is available as a standalone Python package on PyPI (Johnsen, 2022). Accuracy of this implementation is verified in automated test suites in both TKLFP and Cleo packages.\n\n\nOptogenetic stimulation\n\nCleo simulates optogenetic stimulation by combining a model of light propagation with an opsin model relating light to current. The light model is based on Kubelka-Munk light propagation, operating on the assumption that the medium is optically homogeneous and that particles are larger than the light wavelength (Foutz et al., 2012; Vo-Dinh, 2003). Cleo includes absorbance, scattering, and refraction parameters for 473-nm (blue) light as given in Foutz et al. (2012).\n\nIndependent of the light propagation model, Cleo provides two different opsin models. One is a four-state Markov model as presented in (Evans et al., 2016), which captures rise, peak, plateau, and fall dynamics as the opsin is activated and deactivated through a Markov process. Additionally, by defining conductance rather than current directly, the model is able to reproduce the photocurrent’s dependence on the membrane potential (see Figure 4.3). While the four-state model fits experimental data fairly well, the code is structured so that the three- or six-state models in (Evans et al., 2016) could also be easily implemented. Because the Markov model depends on somewhat realistic membrane potential and resistance values, however, it is not well suited for many pre-existing models that do not. To that end, Cleo also provides a simplified model that delivers current (of arbitrary units) proportional to light at the neuron. Users can also specify both the probability that cells of a target population express an opsin and the per-cell expression level."
  },
  {
    "objectID": "src/aim1.html#results",
    "href": "src/aim1.html#results",
    "title": "4  Aim 1 - A CLOC simulation testbed",
    "section": "Results",
    "text": "Results\n\nModel validation\nTo verify that light and opsin models behaved as expected, we reproduced figures illustrating the optic fiber light transmission profile found in Figure 2a,b of Foutz et al. (2012) and the photocurrent in response to the ramping light intensity from Figure 4c of Evans et al. (2016). Light intensity-firing rate relationship was qualitatively similar to that originally reported, though differing in some respects due to the use of point neurons rather than morphological neurons. See Figure 4.3 for details. Additionally, preliminary experiments show that the simplified, proportional current opsin model is able to produce a firing response qualitatively similar to that of the Markov model.\n\n\n\n\n\n\n\nFigure 4.3: Validation of the optogenetics module. (A) Light transmittance \\(T\\) as a function of radius and axial distance from the optic fiber tip. Transmittance refers to the irradiance \\(\\text{Irr}\\) as a proportion of the irradiance at the fiber tip \\(\\text{Irr}_0\\). After Figure 2a from Foutz et al. (2012). (B) Light transmittance \\(T\\) as a function of distance \\(z\\) straight out from the fiber tip for different optic fiber sizes. After Figure 2b from Foutz et al. (2012). (C) Photocurrent \\(I_\\text{opto}\\) for ramping light of different intensities. After the figure produced by the “ramp” protocol from the default PyRhO simulator Evans et al. (2016). (D) Neuron firing rates in response to optical stimulation with 5-ms pulse frequencies ranging from 1 to 200 Hz. The left column re-plots data from Foutz et al. (2012). The middle column shows results for an LIF neuron with a simple opsin, and the right column for a tonic AdEx neuron (Gerstner et al., 2014) with a Markov opsin model. The top row shows results for different light intensities: 100%, 120%, and 140% of the threshold for producing a single spike with a 5-ms pulse. The bottom row shows results for different expression levels relative to the default, \\(\\rho_{\\text{rel}}\\). The irradiance used for these simulations was 120% of the single-spike threshold.\n\n\n\n\nExample experiments\nIn order to demonstrate Cleo’s utility to the public, we implemented three example experiments to feature in the upcoming publication:\n\nClosed-loop inhibition of a traveling wave in a rodent somatosensory cortex model (Moldakarimov et al., 2018). This experiment features a simple on/off control scheme where light activating an inhibitory opsin is turned on whenever the number of spikes detected at the optrode exceeds a threshold. The result is that while a wave of activity spreads outward through sensory cortex in response to a stimulus, the area around the optrode remains unperturbed. An experiment of this sort could explore the consequences of traveling waves in sensory cortex on perception.\nFeedback control of layer 2/3 interneurons, disrupting plasticity in a model of primary visual cortex (Wilmes and Clopath, 2019). In this model, a top-down reward signal to vasoactive intestinal peptide (VIP) interneurons inhibits a population of parvalbumin (PV) interneurons, in turn disinhibiting a population of pyramidal cells (PC). However, using a proportional-integral (PI) feedback controller, we clamp the firing rate of interneurons, blocking this disinhibtion. Without increased PC firing, synaptic weights corresponding to the rewarded stimulus no longer increase, thus demonstrating how feedback control can disrupt normal circuit function.\nOptogenetic evocation of sharp wave-ripples in an anatomically detailed model of hippocampus (Aussel et al., 2022, 2018). This uses linear quadratic regulator control to evoke a reference sharp wave-ripple LFP signature. See Figure 4.4 for details, and note that feedback control, not looking ahead, so to speak, fails to evoke the reference signal at the desired time. The strategy I propose in Chapter 5 should remedy this.\n\n\n\n\n\n\n\n\nFigure 4.4: An example application of Cleo to the anatomical hippocampus model from Aussel et al. (2022, 2018). (A) A 2.5 mm-thick slice of the 15 mm-tall model is shown. The model consists of four regions, entorhinal cortex (EC), dentate gyrus (DG), CA3, and CA1. Electrode contacts are represented as black dots and are in the same location as in the original model. Two light sources are shown in EC. Nine other such pairs (for a total of 20 light sources) not pictured here were spaced regularly parallel to the z axis. (B) Results are shown for ten trials each of three stimulation paradigms: naïve open-loop, where the input is simply a mirrored, rectified version of the reference signal; model-based open-loop, where a controller is run offline on a simulated model; and feedback control, where a controller is run using online measurements. Input \\(\\text{Irr}_0\\) is the light intensity at the tip of each optic fiber. The system output TKLFP refers to the Teleńczuk kernel LFP approximation.\n\n\n\n\nOpen-source code and documentation\nCleo is open-source and can be installed from the Python Package Index under the name cleosim. The code can be found on GitHub. Documentation, including an overview, tutorials, and API reference, can be found at https://cleosim.readthedocs.io."
  },
  {
    "objectID": "src/aim1.html#limitations",
    "href": "src/aim1.html#limitations",
    "title": "4  Aim 1 - A CLOC simulation testbed",
    "section": "Limitations",
    "text": "Limitations\n\nBecause we (and Brian) prioritize point neuron models, Cleo does not currently support advanced, morphology-dependent features of neural dynamics as well as recording and stimulation. This would preclude realistically simulating extracellular potentials as well as the effects of spike sorting, for example.  However, if features such as these are needed, Cleo could be developed further to integrate with Brian’s morphological neuron features. And in the case of LFP, at least one other method exists for point-neuron LFP approximation which could be implemented to help compensate for the limitations of TKLFP (Mazzoni et al., 2015).\nBoth a strength and a limitation of Cleo’s design is that it depends on whatever model the user provides. This avoids the pitfall of painstakingly developing stock models that may or may not prove useful to researchers and instead lets them identify or develop a model that adequately describes the phenomena being studied. If a sufficiently realistic model for the studied system does not exist, however, developing one may be prohibitively costly, becoming a computational project in its own right as opposed to simply a stepping-stone towards an experiment. In these cases we suggest that a workaround could be to test a variety of potential models to identify which experimental configurations would be robust to unknown properties of the system. Indeed, the desired experiment in this case could be one that best adjudicates between these hypotheses.\nRegarding optogenetics, currently only channelrhodopsin-2 model parameters are included—comparing the effectiveness of different opsins will require first obtaining parameters. This is important since improved opsins (Gunaydin et al., 2010; Hochbaum et al., 2014; Kishi et al., 2022; Klapoetke et al., 2014; Lin et al., 2013; Mager et al., 2018; Sridharan et al., 2022), chloride pumps (Berndt et al., 2016; Chuong et al., 2014; Gradinaru et al., 2010), channels (Govorunova et al., 2017, 2015), and other innovations (Berndt et al., 2016; Vierock et al., 2021) have been engineered. Thankfully, parameters for many opsins are available in published literature (Bansal et al., 2021, 2020a, 2020b; Gupta et al., 2019; Saran et al., 2018). Another limitation is support for multiple simultaneous opsins or light sources. At present, the user could manually include separate current terms for each opsin which is slow and cumbersome, but I plan on remedying this shortly to better support multi-channel optogenetics for Chapter 5 and Chapter 6."
  },
  {
    "objectID": "src/aim1.html#summary-of-contributions",
    "href": "src/aim1.html#summary-of-contributions",
    "title": "4  Aim 1 - A CLOC simulation testbed",
    "section": "Summary of contributions",
    "text": "Summary of contributions\nCleo thus provides a simulation environment facilitating and accelerating the adoption and development of CLOC methods. Multiple features were designed to reflect this need, for example, neural simulation and experimental configuration at an intermediate level of realism, relevant recording and stimulation modalities, modular software architecture, flexible interfacing that can be easily adapted to existing Brian models, and arbitrary closed-loop processing enabling realistic processing delays. Moreover, designing Cleo to help experimental labs to test and potentially adopt CLOC methods, we have developed virtual experiments to serve as examples as well as thorough online documentation.\n\n\n\n\nAussel A, Buhry L, Tyvaert L, Ranta R. 2018. A detailed anatomical and mathematical model of the hippocampal formation for the generation of sharp-wave ripples and theta-nested gamma oscillations. Journal of Computational Neuroscience 45:207–221. doi:10.1007/s10827-018-0704-x\n\n\nAussel A, Ranta R, Aron O, Colnat-Coulbois S, Maillard L, Buhry L. 2022. Cell to network computational model of the epileptic human hippocampus suggests specific roles of network and channel dysfunctions in the ictal and interictal oscillations. Journal of Computational Neuroscience. doi:10.1007/s10827-022-00829-5\n\n\nBansal H, Gupta N, Roy S. 2021. Theoretical analysis of optogenetic spiking with ChRmine, bReaChES and CsChrimson-expressing neurons for retinal prostheses. Journal of Neural Engineering 18:0460b8. doi:10.1088/1741-2552/ac1175\n\n\nBansal H, Gupta N, Roy S. 2020a. Theoretical Analysis of Low-power Bidirectional Optogenetic Control of High-frequency Neural Codes with Single Spike Resolution. Neuroscience 449:165–188. doi:10.1016/j.neuroscience.2020.09.022\n\n\nBansal H, Gupta N, Roy S. 2020b. Comparison of low-power, high-frequency and temporally precise optogenetic inhibition of spiking in NpHR, eNpHR3.0 and Jaws-expressing neurons. Biomedical Physics and Engineering Express 6:045011. doi:10.1088/2057-1976/ab90a1\n\n\nBerndt A, Lee SY, Wietek J, Ramakrishnan C, Steinberg EE, Rashid AJ, Kim H, Park S, Santoro A, Frankland PW, Iyer SM, Pak S, Ährlund-Richter S, Delp SL, Malenka RC, Josselyn SA, Carlén M, Hegemann P, Deisseroth K. 2016. Structural foundations of optogenetics: Determinants of channelrhodopsin ion selectivity. Proceedings of the National Academy of Sciences of the United States of America 113:822–829. doi:10.1073/pnas.1523341113\n\n\nBogdanchikov A, Zhaparov M, Suliyev R. 2013. Python to learn programmingJournal of Physics: Conference Series. IOP Publishing. p. 012027. doi:10.1088/1742-6596/423/1/012027\n\n\nBuzsáki G, Anastassiou CA, Koch C. 2012. The origin of extracellular fields and currents EEG, ECoG, LFP and spikes. Nature Reviews Neuroscience 2012 13:6 13:407–420. doi:10.1038/nrn3241\n\n\nChuong AS, Miri ML, Busskamp V, Matthews GAC, Acker LC, Sørensen AT, Young A, Klapoetke NC, Henninger MA, Kodandaramaiah SB, Ogawa M, Ramanlal SB, Bandler RC, Allen BD, Forest CR, Chow BY, Han X, Lin Y, Tye KM, Roska B, Cardin JA, Boyden ES. 2014. Noninvasive optical inhibition with a red-shifted microbial rhodopsin. Nature Neuroscience 17:1123–1129. doi:10.1038/nn.3752\n\n\nDavison AP, Hines ML, Muller E. 2009. Trends in programming languages for neuroscience simulations. Frontiers in Neuroscience 3:374–380. doi:10.3389/neuro.01.036.2009\n\n\nEvans BD, Jarvis S, Schultz SR, Nikolic K. 2016. PyRhO: A Multiscale Optogenetics Simulation Platform. Frontiers in Neuroinformatics 10:8. doi:10.3389/fninf.2016.00008\n\n\nFoutz TJ, Arlow RL, Mcintyre CC. 2012. Theoretical principles underlying optical stimulation of a channelrhodopsin-2 positive pyramidal neuron. J Neurophysiol 107:3235–3245. doi:10.1152/jn.00501.2011.-Optogenetics\n\n\nGerstner W, Kistler WM, Naud R, Paninski L. 2014. Neuronal dynamics: From single neurons to networks and models of cognition, Neuronal Dynamics: From Single Neurons to Networks and Models of Cognition. Cambridge University Press. doi:10.1017/CBO9781107447615\n\n\nGovorunova EG, Sineshchekov OA, Janz R, Liu X, Spudich JL. 2015. Natural light-gated anion channels: A family of microbial rhodopsins for advanced optogenetics. Science 349:647–650. doi:10.1126/science.aaa7484\n\n\nGovorunova EG, Sineshchekov OA, Rodarte EM, Janz R, Morelle O, Melkonian M, Wong GKS, Spudich JL. 2017. The Expanding Family of Natural Anion Channelrhodopsins Reveals Large Variations in Kinetics, Conductance, and Spectral Sensitivity. Scientific Reports 7:1–10. doi:10.1038/srep43358\n\n\nGradinaru V, Zhang F, Ramakrishnan C, Mattis J, Prakash R, Diester I, Goshen I, Thompson KR, Deisseroth K. 2010. Molecular and Cellular Approaches for Diversifying and Extending Optogenetics. Cell 141:154–165. doi:10.1016/j.cell.2010.02.037\n\n\nGunaydin LA, Yizhar O, Berndt A, Sohal VS, Deisseroth K, Hegemann P. 2010. Ultrafast optogenetic control. Nature Neuroscience 13:387–392. doi:10.1038/nn.2495\n\n\nGupta N, Bansal H, Roy S. 2019. Theoretical optimization of high-frequency optogenetic spiking of red-shifted very fast-Chrimson-expressing neurons. Neurophotonics 6:1. doi:10.1117/1.nph.6.2.025002\n\n\nHagen E, Næss S, Ness TV, Einevoll GT. 2018. Multimodal modeling of neural network activity: Computing LFP, ECoG, EEG, and MEG signals with LFPy 2.0. Frontiers in Neuroinformatics 12:92. doi:10.3389/fninf.2018.00092\n\n\nHochbaum DR, Zhao Y, Farhi SL, Klapoetke N, Werley CA, Kapoor V, Zou P, Kralj JM, MacLaurin D, Smedemark-Margulies N, Saulnier JL, Boulting GL, Straub C, Cho YK, Melkonian M, Wong GKS, Harrison DJ, Murthy VN, Sabatini BL, Boyden ES, Campbell RE, Cohen AE. 2014. All-optical electrophysiology in mammalian neurons using engineered microbial rhodopsins. Nature Methods 11:825–833. doi:10.1038/NMETH.3000\n\n\nHolt GR, Koch C. 1999. Electrical interactions via the extracellular potential near cell bodies. Journal of Computational Neuroscience 6:169–184. doi:10.1023/A:1008832702585\n\n\nJohnsen K. 2022. Kjohnsen/tklfp: V0.2.0. doi:10.5281/zenodo.6787979\n\n\nKishi KE, Kim YS, Fukuda M, Inoue M, Kusakizako T, Wang PY, Ramakrishnan C, Byrne EFX, Thadhani E, Paggi JM, Matsui TE, Yamashita K, Nagata T, Konno M, Quirin S, Lo M, Benster T, Uemura T, Liu K, Shibata M, Nomura N, Iwata S, Nureki O, Dror RO, Inoue K, Deisseroth K, Kato HE. 2022. Structural basis for channel conduction in the pump-like channelrhodopsin ChRmine. Cell 185:672–689.e23. doi:10.1016/j.cell.2022.01.007\n\n\nKlapoetke NC, Murata Y, Kim SS, Pulver SR, Birdsey-Benson A, Cho YK, Morimoto TK, Chuong AS, Carpenter EJ, Tian Z, Wang J, Xie Y, Yan Z, Zhang Y, Chow BY, Surek B, Melkonian M, Jayaraman V, Constantine-Paton M, Wong GKS, Boyden ES. 2014. Independent optical excitation of distinct neural populations. Nature Methods 11:338–346. doi:10.1038/nmeth.2836\n\n\nLin JY, Knutsen PM, Muller A, Kleinfeld D, Tsien RY. 2013. ReaChR: A red-shifted variant of channelrhodopsin enables deep transcranial optogenetic excitation. Nature Neuroscience 16:1499–1508. doi:10.1038/nn.3502\n\n\nMager T, Morena DLDL, Senn V, Schlotte J, Derrico A, Feldbauer K, Wrobel C, Jung S, Bodensiek K, Rankovic V, Browne L, Huet A, Jüttner J, Wood PG, Letzkus JJ, Moser T, Bamberg E. 2018. High frequency neural spiking and auditory signaling by ultrafast red-shifted optogenetics. Nature Communications 9:1–14. doi:10.1038/s41467-018-04146-3\n\n\nMazzoni A, Lindén H, Cuntz H, Lansner A, Panzeri S, Einevoll GT. 2015. Computing the Local Field Potential (LFP) from Integrate-and-Fire Network Models. PLOS Computational Biology 11:e1004584. doi:10.1371/JOURNAL.PCBI.1004584\n\n\nMoldakarimov S, Bazhenov M, Feldman DE, Sejnowski TJ. 2018. Structured networks support sparse traveling waves in rodent somatosensory cortex. Proceedings of the National Academy of Sciences of the United States of America 115:5277–5282. doi:10.1073/pnas.1710202115\n\n\nMuller E, Bednar JA, Diesmann M, Gewaltig MO, Hines M, Davison AP. 2015. Python in neuroscience. Frontiers in Neuroinformatics 9:11. doi:10.3389/fninf.2015.00011\n\n\nNason SR, Vaskov AK, Willsey MS, Welle EJ, An H, Vu PP, Bullard AJ, Nu CS, Kao JC, Shenoy KV, Jang T, Kim H-S, Blaauw D, Patil PG, Chestek CA. 2020. A low-power band of neuronal spiking activity dominated by local single units improves the performance of brainmachine interfaces. Nature Biomedical Engineering 2020 1–11. doi:10.1038/s41551-020-0591-0\n\n\nParasuram H, Nair B, D’Angelo E, Hines M, Naldi G, Diwakar S. 2016. Computational modeling of single neuron extracellular electric potentials and network local field potentials using LFPsim. Frontiers in Computational Neuroscience 10:65. doi:10.3389/fncom.2016.00065\n\n\nPettersen KH, Lindén H, Dale AM, Einevoll GT. 2012. Extracellular spikes and CSD. Handbook of neural activity measurement 1:92–135.\n\n\nSaran S, Gupta N, Roy S. 2018. Theoretical analysis of low-power fast optogenetic control of firing of Chronos-expressing neurons. Neurophotonics 5:1. doi:10.1117/1.nph.5.2.025009\n\n\nSridharan S, Gajowa MA, Ogando MB, Jagadisan UK, Abdeladim L, Sadahiro M, Bounds HA, Hendricks WD, Turney TS, Tayler I, Gopakumar K, Oldenburg IA, Brohawn SG, Adesnik H. 2022. High-performance microbial opsins for spatially and temporally precise perturbations of large neuronal networks. Neuron 110:1139–1155.e6. doi:10.1016/j.neuron.2022.01.008\n\n\nStimberg M, Brette R, Goodman DFM. 2019. Brian 2, an intuitive and efficient neural simulator. eLife 8. doi:10.7554/eLife.47314\n\n\nTelenczuk B, Telenczuk M, Destexhe A. 2020. A kernel-based method to calculate local field potentials from networks of spiking neurons. Journal of Neuroscience Methods 344:108871. doi:10.1016/j.jneumeth.2020.108871\n\n\nThornton C, Hutchings F, Kaiser M. 2019. The virtual electrode recording tool for extracellular potentials (VERTEX) Version 2.0: Modelling in vitro electrical stimulation of brain tissue. Wellcome Open Research 4. doi:10.12688/wellcomeopenres.15058.1\n\n\nTomsett RJ, Ainsworth M, Thiele A, Sanayei M, Chen X, Gieselmann MA, Whittington MA, Cunningham MO, Kaiser M. 2015. Virtual Electrode Recording Tool for EXtracellular potentials (VERTEX): Comparing multi-electrode recordings from simulated and biological mammalian cortical tissue. Brain Structure and Function 220:2333–2353. doi:10.1007/s00429-014-0793-x\n\n\nVierock J, Rodriguez-Rozada S, Dieter A, Pieper F, Sims R, Tenedini F, Bergs ACF, Bendifallah I, Zhou F, Zeitzschel N, Ahlbeck J, Augustin S, Sauter K, Papagiakoumou E, Gottschalk A, Soba P, Emiliani V, Engel AK, Hegemann P, Wiegert JS. 2021. BiPOLES is an optogenetic tool developed for bidirectional dual-color control of neurons. Nature Communications 12:1–20. doi:10.1038/s41467-021-24759-5\n\n\nVo-Dinh T. 2003. Biomedical Photonics: Handbook, Biomedical Photonics: Handbook. CRC Press. doi:10.1001/archfaci.3.3.207\n\n\nWilmes KA, Clopath C. 2019. Inhibitory microcircuits for top-down plasticity of sensory representations. Nature Communications 10:5055. doi:10.1038/s41467-019-12972-2"
  },
  {
    "objectID": "src/aim2.html#rationale",
    "href": "src/aim2.html#rationale",
    "title": "5  Aim 2 - Multi-input CLOC",
    "section": "Rationale",
    "text": "Rationale\n\nThe power of closed-loop optogenetic control (CLOC, henceforth referring specifically to feedback control; see Section 3.1.1) is limited by the degrees of freedom provided by the optogenetic actuation scheme. One important distinction in possible actuation schemes is between unidirectional and bidirectional actuation, referring to whether a single opsin type or both excitatory and inhibitory opsins are used simultaneously. Unidirectional control has obvious shortcomings: for example, an excitatory opsin alone can only raise the firing rate of target neurons, not lower it or even clamp to a baseline level. This setup would also be unable to lower the firing rate quickly, in the case of a dynamic reference trajectory. Moreover, besides enabling bidirectional stimulation, general multi-input methods could enable more precise control by targeting different neurons simultaneously, such as stimulation of cells at different depths in a cortical column or across columns.\n\nWhile a previous study (Newman et al., 2015) has already laid the foundation for bidirectional CLOC, it does not feature the generalizability and scalability of the model-based, optimal control algorithms introduced by later work (Bolus et al., 2021) (see Section 3.3) for unidirectional actuation. This adaptive linear-quadratic regulator (LQR) approach is more robust to disturbances and can scale to multi-input multi-output (MIMO) systems. Moreover, its behavior can be easily configured by setting penalties on state error, the control signal, and even the derivative of the control signal to encourage smooth actuation.\n\nThus, a natural goal for furthering CLOC is to combine the advantages of multi-input/bidirectional actuation and model-based optimal control—however, this poses additional challenges and opportunities. The adaptive LQR method previously developed has limited application for multi-input actuation because it does not model the constraint that the input (light intensity) must be nonnegative. While violations of this constraint are relatively infrequent and of little consequence when using an excitatory opsin to reach elevated, slowly varying trajectories, a dual-input scenario would be different. For instance, the controller might call for negative inhibitory input rather than positive excitatory input. A heuristic workaround to this is to use light pairs (e.g., blue and red) and treat them as the positive and negative directions of a single actuator. This allows us to continue to use simple and fast LQR methods but fails to model inhibitory and excitatory opsins separately and precludes alternate light configurations, where there are not excitatory/inhibitory pairs each one overlapping little with others.\n\nInnovation\nI propose addressing this problem using model predictive control (MPC), which is widely used for its flexibility in implementing optimal control with constraints. Rather than computing the control signal from the current error signal at each step, MPC looks ahead, optimizing over the predicted trajectory some finite number of steps into the future, in what is known as “receding horizon control.” The downside is that this requires solving an optimization problem (a quadratic program for straightforward linear dynamical systems) at every control step, which is more costly than the matrix operations typical of LQR. The latency caused by this computation causes real-time control performance to suffer. Even so, I hypothesize that MPC will be able to better optimize multi-input optogenetic stimulation while accommodating experimental constraints and considerations during real-time control on timescales relevant to network-level descriptions of neural activity. I plan to achieve this aim by adapting previously demonstrated linear models, adding input constraints and costs, and assessing control quality of MPC compared to the heuristic LQR approach previously described as I simulate multi-output feedback control of firing rates and gamma oscillations observed in local field potentials (LFP).\n\n\n\n\n\n\n\n\n\nFigure 5.1: An illustration of how MPC optimizes the system input over a receding horizon. By Martin Behrendt, licensed under CC BY-SA 3.0."
  },
  {
    "objectID": "src/aim2.html#approach",
    "href": "src/aim2.html#approach",
    "title": "5  Aim 2 - Multi-input CLOC",
    "section": "Approach",
    "text": "Approach\n\nSystem and controller formulation\nNaturally, the model is a vital element of MPC. I will use a previously developed Gaussian linear dynamical system (GLDS) model (Bolus et al., 2021), which has been shown to reliably capture firing rate dynamics in a light-driven spiking neuron system. The discrete-time GLDS is governed by the following equations:\n\\[\n\\begin{aligned}\nx_{t + 1} &= Ax_{t} + Bu_{t} + w_t  \\\\\ny_{t} &= Cx_{t} + d  \\\\\nz_{t} &= y_{t} + v_t  \\\\\n\\end{aligned}\n\\]\nwhere \\(x_{t} \\in \\mathbb{R}^n\\) is the \\(n\\)-dimensional state, \\(u_{t} \\in \\mathbb{R}^k\\) is the \\(k\\)-dimensional stimulus (i.e., \\(k = 2\\) for two opsins, one light source each), \\(y_{t} \\in \\mathbb{R}^m\\) is the firing rate in spikes/timestep (for each of \\(m\\) measured neurons), and \\(z_{t} \\in \\mathbb{R}^m\\) is the number of binned spikes observed at time \\(t\\). \\(A \\in \\mathbb{R}^{n \\times n}\\), \\(B \\in \\mathbb{R}^{n \\times k}\\), and \\(C \\in \\mathbb{R}^{m \\times n}\\) are the state transition, input, and output matrices, respectively. \\(w_{t} \\sim \\mathcal{N}\\left( 0, Q \\right)\\) and \\(v_{t}\\mathcal{\\sim N}\\left( 0, R \\right)\\) are Gaussian-distributed process and measurement noise, respectively, and \\(d \\in \\mathbb{R}^{m \\times 1}\\) represents baseline firing rates. Model order (\\(n\\)) and horizon length (\\(T \\in \\mathbb{N}\\)) will be chosen to balance complexity and prediction error for noise-driven fitting data generated from the test network. The latent state \\(x_{t}\\) will be estimated online using the Kalman filter (Kalman, 1960), driven by the prediction error \\(z_{t} - {\\widehat{y}}_{t|t - 1}\\).\nI will set hard non-negative constraints on the light input as well as a ceiling determined by hardware limitations (i.e., the maximum voltage deliverable to the LED driver). To design an appropriate cost function, I will use a conventional per-time step quadratic form\n\\[\\ell( x_{t},r_{t},u_{t} ) = ( x_{t} - r_{t} )^{T}Q^{\\text{ctrl}}( x_{t} - r_{t} ) + u^{T}R^{\\text{ctrl}}u\\ ,\\]\nwhere \\(r_{t} \\in \\mathbb{R}^n\\) is the reference trajectory at time \\(t\\). \\(Q^{\\text{ctrl}}\\) and \\(R^{\\text{ctrl}}\\) are real \\(n \\times n\\) and \\(k \\times k\\) matrices chosen to appropriately penalize tracking error and stimulus size, respectively. This quadratic cost function formulation lends the problem well to standard optimization techniques—combined with a linear dynamical system, it constitutes the classical linear-quadratic-Gaussian (LQG) control problem.\nThen, at every time step \\(t\\) the controller solves the following quadratic program:\n\\[\n\\begin{aligned}\n    \\text{minimize}{} \\quad & \\sum_{\\tau=t}^{t+T} \\ell(x_\\tau, u_\\tau) \\\\\n    \\text{subject to} \\quad & u_\\tau \\succeq 0 \\\\\n        & x_{\\tau + 1} = Ax_{\\tau}+Bu_\\tau \\\\\n\\end{aligned}\n\\]\nwhere \\(T \\in \\mathbb{N}\\) is the number of steps in the prediction/control horizon and \\(\\succeq\\) indicates an inequality for each element of \\(u_\\tau \\in \\mathbb{R}^k\\). This yields the solution \\(\\tilde{u}_\\tau,...,\\tilde{u}_{\\tau+T-1}\\), of which we take just the first step to apply to the system:\n\\[ u_t = \\tilde{u}_t \\]\n\n\nControl method comparison in silico\nTo confirm my assumption that bidirectional and multi-channel configurations will improve control quality, I will test both unidirectional and bidirectional actuation as well as one-channel and multi-channel configurations for each experiment. (In the bidirectional actuation case, one “channel” includes both an inhibition-triggering and an excitation-triggering light source). Another condition of interest will be to penalize a low-pass-filtered version of the stimulus, which could reflect overheating or ion imbalances caused by prolonged stimulation (Kokaia et al., 2013; Stujenske et al., 2015; Yizhar et al., 2011). This could be added to the linear dynamics and quadratic cost functions without changing the optimization methods, but, as with opsin and channel count, the increased size of the problem could change which configuration performs best. I will also test open-loop, heuristic LQR, and MPC approaches to see whether MPC attains better performance despite a longer computational delay, as hypothesized. Control algorithm computation time will be measured and used during simulations as a realistic delay. To evaluate controller performance, I will use metrics such as the mean-squared error (MSE) between the reference firing rate and the Gaussian window-smoothed firing rate of the spikes received by the controller during the trial.\nIn the first experiment, I will simulate multi-output control of firing rates in an attempt to clamp population activity. Wagenaar et al. (2005) and Newman et al. (2013) laid the foundation for this by clamping aggregate, population firing rates, and Bolus et al. (2021) took this further by treating firing rates of individual neurons separately, though with a single optic fiber input. This is an obvious case where multiple inputs should provide more control, allowing us to manipulate neurons (or groups of neurons in the case of unsorted threshold crossings) more individually, each to its own baseline. The experiment will be performed on a Poisson linear dynamical system (PLDS) model (Macke et al., 2011) fit to optogenetic input/spike output data from a spiking neural network (SNN) model. The SNN model will contain necessary features, such as cell types, time-varying exogenous input, and connectivity profiles, to produce stochastic firing patterns with unpredictable disturbances and will be simulated together with the recording and stimulation facilities of Chapter 4.\nAs another experiment, I propose another form of network-level control—manipulating the oscillatory signatures found in LFP signals. Gamma oscillations (30-90 Hz) are one such example, which have been shown to have time-varying properties and interact with other oscillatory bands. Interestingly, gamma rhythms can even show phase coherence in distant brain regions such as visual cortex in opposite hemispheres, which has been hypothesized to play a role in information integration (Buzsáki and Wang, 2012). I plan to test control methods on a virtual experiment of this phenomenon by simulating two populations of neurons exhibiting gamma oscillations (Brunel and Wang, 2003; Wang and Buzsáki, 1996) with long-range connections mediating gamma frequency coherence, again using the framework from Chapter 4. I will then perform feedback control on the LFP signal to counter the natural phase locking that arises, providing an opportunity to test how well LFP can be controlled on a <100-ms timescale of a single gamma cycle."
  },
  {
    "objectID": "src/aim2.html#expected-results",
    "href": "src/aim2.html#expected-results",
    "title": "5  Aim 2 - Multi-input CLOC",
    "section": "Expected results",
    "text": "Expected results\nI expect that bidirectional, multi-channel, and model predictive control will be perform better than unidirectional, single-channel, and LQR control, respectively for both experiments, despite the added computational cost these methods require. I also expect that restricting the controller through hard constraints or prolonged stimulation penalties will also be possible with the more sophisticated methods without greatly increasing the error."
  },
  {
    "objectID": "src/aim2.html#preliminary-results",
    "href": "src/aim2.html#preliminary-results",
    "title": "5  Aim 2 - Multi-input CLOC",
    "section": "Preliminary results",
    "text": "Preliminary results\nBasic simulations controlling a linear dynamical system model fit to experimental data show the advantages of bidirectional control and of MPC (see Figure 5.2). Bidirectional actuation allows the system to avoid overshooting the reference, in the case of LQR, or to minimize error faster by first exciting then inhibiting, in the case of MPC. MPC’s advantages in looking ahead also clearly allow it to follow the reference more closely than the heuristic LQR controller (assigning negative inputs to the second light source).\n\n\n\n\n\nFigure 5.2: Simulated control of an linear dynamical system with 1- and 2-input control, using LQR and MPC controllers. The top panel of each contains the reference and the actual firing rate, in spikes/second. The bottom contains the light intensity, in terms of mW/mm2, where blue represents light for an excitatory opsin (such as ChR2) and red-orange that for an inhibitory opsin (such as Jaws)."
  },
  {
    "objectID": "src/aim2.html#sec-aim2-pitfalls",
    "href": "src/aim2.html#sec-aim2-pitfalls",
    "title": "5  Aim 2 - Multi-input CLOC",
    "section": "Potential pitfalls & alternative strategies",
    "text": "Potential pitfalls & alternative strategies\nThere are some limitations in the proposed GLDS model that may need to be addressed. While it was adequate for the experiments in Bolus et al. (2021), a Poisson (Macke et al., 2011) or other output nonlinearity may be needed in the case that a standard GLDS does not fit the data well. While this would likely make the estimation of \\(x\\) more expensive, the underlying dynamics could remain linear, leaving the same underlying quadratic program for the controller to solve.\nThis touches another potential concern: the speed of the algorithm. If the optimization problem takes too long to solve, there are a few options to explore. One is that some variations in the control scheme can help balance speed and performance, such as letting the control horizon be shorter than the prediction horizon, which shrinks the optimization problem. Likewise, the control period can be longer than the time step of the system, reducing how often the control signal is computed. If conventional methods such as these are unsuccessful, I may turn to methods such as that described in Wang and Boyd (2010) or training an artificial neural network to approximate the exact solution of the quadratic program or to minimize the cost directly. Another potential solution is explicit MPC (Bemporad et al., 2002), which finds a piecewise-affine explicit solution to the quadratic program which can be faster than using a solver to obtain the implicit solution for small-enough problems.\n\n\n\n\nBemporad A, Morari M, Dua V, Pistikopoulos EN. 2002. The explicit linear quadratic regulator for constrained systems. Automatica 38:3–20. doi:10.1016/S0005-1098(01)00174-1\n\n\nBolus MF, Willats AA, Rozell CJ, Stanley GB. 2021. State-space optimal feedback control of optogenetically driven neural activity. Journal of neural engineering 18:036006. doi:10.1101/2020.06.25.171785\n\n\nBrunel N, Wang X-J. 2003. What determines the frequency of fast network oscillations with irregular neural discharges? I. Synaptic dynamics and excitation-inhibition balance. Journal of neurophysiology 90:415–430.\n\n\nBuzsáki G, Wang X-J. 2012. Mechanisms of Gamma Oscillations. Annual Review of Neuroscience 35:203–225. doi:10.1146/annurev-neuro-062111-150444\n\n\nKalman RE. 1960. A new approach to linear filtering and prediction problems. Journal of Fluids Engineering, Transactions of the ASME 82:35–45. doi:10.1115/1.3662552\n\n\nKokaia M, Andersson M, Ledri M. 2013. An optogenetic approach in epilepsy. Neuropharmacology 69:89–95. doi:10.1016/j.neuropharm.2012.05.049\n\n\nMacke JH, Buesing L, Cunningham JP, Yu BM, Shenoy KV, Sahani M. 2011. Empirical models of spiking in neural populationsAdvances in Neural Information Processing Systems. Curran Associates, Inc.\n\n\nNewman JP, Fong MF, Millard DC, Whitmire CJ, Stanley GB, Potter SM. 2015. Optogenetic feedback control of neural activity. eLife. doi:10.7554/eLife.07192\n\n\nNewman J, Zeller-Townson R, Fong M, Arcot Desai S, Gross R, Potter S. 2013. Closed-Loop, Multichannel Experimentation Using the Open-Source NeuroRighter Electrophysiology Platform. Frontiers in Neural Circuits 6.\n\n\nStujenske JM, Spellman T, Gordon JA. 2015. Modeling the Spatiotemporal Dynamics of Light and Heat Propagation for InVivo Optogenetics. Cell Reports 12:525–534. doi:10.1016/j.celrep.2015.06.036\n\n\nWagenaar DA, Madhavan R, Pine J, Potter SM. 2005. Controlling bursting in cortical cultures with closed-loop multi-electrode stimulation. Journal of Neuroscience 25:680–688. doi:10.1523/JNEUROSCI.4209-04.2005\n\n\nWang X-J, Buzsáki G. 1996. Gamma oscillation by synaptic inhibition in a hippocampal interneuronal network model. Journal of neuroscience 16:6402–6413.\n\n\nWang Y, Boyd S. 2010. Fast Model Predictive Control Using Online Optimization. IEEE TRANSACTIONS ON CONTROL SYSTEMS TECHNOLOGY 18:267. doi:10.1109/TCST.2009.2017934\n\n\nYizhar O, Fenno LE, Davidson TJ, Mogri M, Deisseroth K. 2011. Optogenetics in Neural Systems. Neuron 71:9–34. doi:10.1016/j.neuron.2011.06.004"
  },
  {
    "objectID": "src/aim3.html#rationale",
    "href": "src/aim3.html#rationale",
    "title": "6  Aim 3 - Control of latent population dynamics",
    "section": "Rationale",
    "text": "Rationale\n\nAs technology for recording from the brain has improved, systems neuroscience has shifted increasingly towards a reduced-dimensionality, population coding perspective in many brain areas (Barack and Krakauer, 2021; Churchland et al., 2012; Cunningham and Yu, 2014; Kalaska et al., 1983). This reflects the observation that while the activity of any single neuron can vary greatly across trials where external variables are controlled, underlying latent variables can be decoded from the population which are much more predictable and reproducible. Moreover, formulating this latent variable as a dynamical state whose evolution can be predicted has been shown to improve inference and enable state-of-the-art “decoding” of downstream variables of interest such as movement (Pandarinath et al., 2018; Sani et al., 2021a, 2021b; Willett et al., 2021), mood (Sani et al., 2018), speech (Anumanchipalli et al., 2019), and decision states (Kim et al., 2021; Morcos and Harvey, 2016). Not only does this allow us to infer the output of a given brain region, but it allows us to form hypotheses about how it produces that output by analyzing the dynamical landscape of fixed points (Smith et al., 2021; Sussillo, 2014; Sussillo and Barak, 2013). This is formalized in the Computation through Dynamics (CTD) framework (Vyas et al., 2020).\n\nHowever, while these latent variables have been used to successfully decode other variables of interest, this is a necessary, but insufficent, condition to demonstrate a causal relationship. That is, an association between neural activity variable \\(a\\) and some other variable \\(b\\) may reflect the causal relationship \\(a \\rightarrow b\\), but could also reflect \\(b \\rightarrow a\\) or \\(a \\leftarrow c \\rightarrow b\\). This may be adequate for brain-computer interface (BCI) applications, but verification of that causal relationship is necessary for neuroscience’s goal of deepening our understanding of the architecture and algorithms of brain computations. This requires experimental control (Pearl, 2009) on the level of neural populations, but, as stated by Vyas et al. (2020),\n\nThe challenge is nontrivial; testing CTD models requires a high degree of control over neural activity. The experimenter must be able to manipulate neural states arbitrarily in state space and then measure behavioral and neural consequences of such perturbations[.]\n\n\nCLOC is a natural candidate for this kind of experimental control of latent states for various reasons. The optimal state-space methods already formulated map directly to the latent dynamics models which have generated so much interest in recent systems neuroscience. High-dimensional optogenetic actuation is possible through micro-LED devices (Antolik et al., 2021; Dufour and Koninck, 2015; Eriksson et al., 2022; Jeon et al., 2021; Kathe et al., 2022; Kwon et al., 2015; Mao et al., 2021; Mao et al., 2019; McAlinden et al., 2019; Ohta et al., 2021; Wang et al., 2018; Welkenhuysen et al., 2016), two-photon targeting of individual neurons (Chen et al., 2018; Packer et al., 2015; Ronzitti et al., 2017; Sridharan et al., 2022; Zhang et al., 2018), and genetic targeting. Moreover, real-time feedback can drive a variable neural system towards complex latent state targets which would be attainable with low accuracy at best and not at all at worst with open-loop stimulation 1. However, while it is clear a high degree of control will be needed, it is unknown how this translates to recording, stimulation, and control parameters. Furthermore, finding optimal parameters would likely require extensive trial and error, as well actuation hardware that does not exist or is not readily available, making it costly if not infeasible to do in vivo. One significant open question is whether this kind of control will require actuation on the level of individual neurons, or whether lower-dimensional actuation will suffice.\n\nInnovation\nThus, to give a preliminary answer to this question, I propose to develop technical and conceptual guidelines as I control the latent dynamics of simulated neural populations. First, I will produce virtual models by training recurrent spiking neural networks with state-of-the-art, biologically plausible methods—each differing in their degrees of brain-like architecture and training procedure complexity. I will then use the simulation testbed of Chapter 4 and the multi-input control methods of Chapter 5 to explore how control quality varies with both experimental parameters (such as recording and stimulation channel counts or control algorithms) and system characteristics (such as the size, complexity of the network model). This will both give researchers a tentative idea of the relative importance of each factor of CLOC and, as parameters approach experimental realism, allow us to conjecture as to the number of independent actuators needed to control the latent dynamics of a brain system. My hypothesis is that control quality will plateau with a number of actuators on or near the same level of magnitude as the latent factors used to describe the neural activity—that the per-neuron actuation limit will not be needed."
  },
  {
    "objectID": "src/aim3.html#approach",
    "href": "src/aim3.html#approach",
    "title": "6  Aim 3 - Control of latent population dynamics",
    "section": "Approach",
    "text": "Approach\n\n\n\nFigure 6.1: Overview of latent factor control experiments.\n\n\n\n\n\n\n\n\nFormulate task with latent dynamics hypothesis\nTo model an experiment of interest to neuroscientists, I will first choose a task where latent dynamic analyses have yielded testable hypotheses in animal research. For example, it is hypothesized that motor cortex works as a dynamical system where movement planning essentially sets an initial condition during a preparatory phase. This is demonstrated specifically by decoding reach direction in a delayed reach task from dorsal premotor cortex before movement onset (Churchland et al., 2010; reviewed in Gallego et al., 2017) (see Figure 6.2). One way to causally test this hypothesis would be to manipulate the latent factors corresponding to a certain reach direction despite an absent or contradictory cue and verify whether the subject reaches in the predicted direction.\n\n\n\nFigure 6.2: Illustration of a delayed center-out reach experiment. From Santhanam et al. (2009).\n\n\nAnother potential latent dynamics hypothesis to test could involve sensory integration in decision making. In one “T-maze” task, for example, mice run down a maze, receive a variable number of left and right sensory cues, and at the end choose to go left or right, receiving a reward if they choose the side which they had received more cues from. Morcos and Harvey (2016) find a variety of activity and behavioral patterns for identical evidence presentations and attribute it to different initial conditions in the latent space of population activity. Thus, one could test this hypothesis by driving the system to an identical latent state across trials and verifying that this variability goes away. Simply manipulating the latent decision variable to verify that it determines the animal’s left or right choice—as opposed to reflecting input from the population(s) actually driving behavior—could be of value as well.\n\n\nTrain RSNN models\nAfter identifying a task and latent dynamics hypothesis to test, I will train recurrent spiking neural network (RSNN) models to perform the task. These RSNN models will be defined in 3D space to make them compatible with the electrode and optogenetics models from Aim 1. To avoid painstaking implementation of every known anatomical detail of the brain region(s) involved in the task—an approach which is not guaranteed to include every important detail or capture true circuitry—I propose using a simple, abstract form such as a rectangular prism of cortical tissue and measuring the effect of adding progressivley more brain-like structural constraints (see Section 6.2.6).\nI will then train these models to perform the given task. While a few different methods for training RSNNs exist, I plan on using e-prop (Bellec et al., 2020), a biologically plausible approximation to backpropagation through time (BPTT), the method typically used to train artificial recurrent neural networks (RNNs). This biological plausibility consists in updating synaptic weights using only local information about past activity—“eligibility traces”—and a top-down learning signal and enables learning sparsely firing spike-coding—as opposed to only rate-coding—solutions. While e-prop has been shown to learn complex tasks such as Atari games via reinforcement learning, I propose a simpler supervised learning approach. This is both more data-efficient and would directly allow for the learning of auxiliary variables, which has been shown in one study to make model dynamics more brain-like (Rajalingham et al., 2022) (see Section 6.4).\nTo give a concrete example of inputs and outputs for the case of the delayed center-out reaching task before mentioned, inputs might include the task phase (stop or go), the target position, and the current hand position. The model output might be hand velocity, and the learning signal could be computed from the x/y distance between the current position and the center (target) before (after) the go cue is given. A regularizer term on acceleration could be added to ensure trajectories are smooth.\n\n\nFit dynamical systems model\nAfter a model has been trained to some threshold performance level, I will record spikes and/or LFP from the network while it performs the task. The resulting data will then be used to fit a low-dimensional dynamical systems model. Seeing that the goal of the virtual experiment is to test the causal effect of a latent factor on model output, I propose using system identification methods that prioritize the discovery of those latent factors that are most relevant to behavior. The preferential subspace identification (PSID) method presented by Sani et al. (2021a) is a good candidate, having been shown to predict behavior well with few dimensions. The linear system it produces is also ideal for the control theory methods I develop in Aim 2. In a follow-up study, Sani et al. (2021b) introduce RNN-PSID supporting nonlinearities as well and find empirically that linear dynamics with only a nonlinear mapping from latent to behavior are often sufficient to describe experimental data well. Using a potentially nonlinear output mapping in this way would increase the expressiveness of my models while maintaining underlying linear dynamics for fast optimization.\nAfter fitting a model to data, I will identify latent factors corresponding to variables of interest. These could be individual components of the latent state \\(x\\) directly or simple (e.g., linear) transformations of \\(x\\). In the delayed center-out reaching task, for example, I would expect two factors with which the state at the end of the preparatory period can be used to predict the cued target position.\n\n\nControl of latent factors\nThe next step is then to test whether these latent factors do in fact cause the behavior we observe. Importantly, the model and hypothesis from the previous step were formed without stimulation, since our stated goal is to causally test the latent factors we deduce from passive observation. Thus, I will first need to expand the model by simulating random optogenetic stimulation and fitting an input model—e.g., an input matrix \\(B\\) for the typical LDS case. If this is insufficient to fit the data well, I may need to increase the dimensionality of the latent state \\(x\\) to account for the actuator state (i.e., opsin kinetics) or dimensions of neural activity not arising during unperturbed activity.\nWith an input model, I will then be able to run control experiments. The methods from Aim 2 will calculate optimal actuation strategies as the simulation progresses to drive the identified latent factors to the desired state. Control quality will be assessed for each experiment using metrics such as mean-squared error (MSE) and will serve as the criterion for how successful the experiment was, seeing that low error serves the larger goal of testing the causal relationship with model behavior.\n\n\n\nExploration of experiment parameters and expected effects\nTo guide experimental design, I propose repeating the above process many times to explore how different factors affect control quality, thus informing which investments might be most fruitful. These factors might include:\n\nControl type. Open-loop control is faster and easier but cannot counteract variability inherent to the system and in the presence of model mismatch will fail to reach the target. Closed-loop methods will almost certainly perform better, but are harder to implement. Moreover, closed-loop control offers a range of options spanning the cost/quality spectrum, with the fast linear quadratic regulator (LQR) on one end and the expensive long-horizon, high-resolution model predictive control (MPC) on the other.\nTotal recording/stimulation channel count (\\(m + k\\)). It may be helpful to think of these two parameters together, since they both require limited space in a device that is placed in or on the brain. I expect control quality to increase with channel count up to a point where the computational cost required for closed-loop control outweighs the benefits.\nRecording/stimulation channel ratio (\\(m/k\\)). Related to the previous point, when space for interface is hardware, it is an open question whether the current landscape of neuroscience technology, which has prioritized high-channel-count recording over stimulation, is the most effective for causal perturbations of neural dynamics.\nData collection budget. Data collection is not free, and thus must be considered especially when considering the data-efficiency advantages of feedback control. This is also relevant for choosing models to control the system—with little training data, for example, a simple, easy-to-fit model may outperform a more expressive, data-hungry one.\nOptogenetic stimulation parameters. These could include the number and type of opsins and genetic targeting. Using at least two opsins could be expected to perform better than just one, as shown in Aim 2, though many more might not be useful due to overlapping spectral sensitivity and increased computation time. The effect of genetic targeting will likely depend on how well the targeted population correlates with the latent factor of interest.\n\n\n\nExploration of model realism and expected effects\nAs explained above, I propose using abstract RSNN models with varying degrees of brain-like realism rather than extremely detailed models. This is because highly detailed models are difficult to develop and expensive to simulate—moreover, it is hard to say exactly when a model has enough to detail to behave similarly to a real brain. On the other hand, by assessing the effect of a handful of brain-like features on how well we can contol latent neural dynamics in silico, I hope to identify trends that give a rough outlook of doing so in vivo. For example, if control quality tends to drop with the addition of each feature, we might infer control of a real brain will be considerably more challenging than in simulations. On the other hand, if control quality does not decrease considerably with brain similarity, we might have reason to be more optimistic.\nThe brain-like features I propose assessing include structural characteristics such as:\n\nVariability. Brains are far from deterministic, with unpredictability on the level of synaptic transmission all the way up to firing rates across a population. Small-scale stochasticity encourages redundance and robustness, which may make the model harder to “hack,” or perturb unnaturally. I expect that large-scale variability, such as an unmodeled input to the region, will highlight the advantages of feedback control.\nNetwork size (how many neurons are in the model). More neurons would likely mean more dimensions along which activity can vary, complicating the prospect of arbitrary control.\nSubpopulation structure. This could include constraining connectivity to circuits of brain regions, cortical layers, and cell types. This could also make control harder if the latent factor to control operates in cells that are multiple synapses away from those stimulated or if dynamics become driven by recurrent connections more than stimulation.\nConnectivity profiles. Cell pairs within a given population might have a uniform or a spatially dependent connection probability. I expect this, like subpopulation structure, to encourage segregated dynamics which could be either easier or harder to perturb.\nCell diversity. Cells might have uniform or a random distribution of parameters such as membrane resistance, synaptic transmission delays, resting potentials, adaptivity, etc. Again, I expect this would encourage the segregation of neural dynamics.\nNeuron model complexity. Individual cell models could range from simple leaky integrate-and-fire (LIF) to Hodgkin-Huxley dynamics. I do not expect this to considerably impact control quality.\n\nThey also include characteristics about how the model is trained. A real brain regions is capable of performing not only one, simple, stereotyped task, but many tasks in many contexts. Therefore, another way to make models more brain-like is to diversify their experience—to train them on other tasks. It has been shown that this can result in an RNN reusing computational motifs learned in one task to solve others (Driscoll et al., 2022; Yang et al., 2019)."
  },
  {
    "objectID": "src/aim3.html#expected-results",
    "href": "src/aim3.html#expected-results",
    "title": "6  Aim 3 - Control of latent population dynamics",
    "section": "Expected results",
    "text": "Expected results\nIn addition to the specific expectations for experimental and model parameters described above, I expect that control quality will be relatively low (error will be high) especially for low actuator counts \\(k\\). However, as previously stated, I do not anticipate that \\(k\\) will need to approach the per-neuron limit either; rather, that low-error control will be possible with \\(k\\) close to the same order of magnitude as the latent state dimensionality. While expectations for each brain-like model feature are explained above, I predict that on the whole, control quality will decrease as models become more realistic. However, I predict that that that decrease will plateau, providing some confidence in my results and assurance that the complexity of the real brain may not be an insurmountable barrier to future in-vivo experiments."
  },
  {
    "objectID": "src/aim3.html#sec-aim3-pitfalls",
    "href": "src/aim3.html#sec-aim3-pitfalls",
    "title": "6  Aim 3 - Control of latent population dynamics",
    "section": "Potential pitfalls & alternative strategies",
    "text": "Potential pitfalls & alternative strategies\nOne potential problem is that the RSNN models could learn dynamics that are not very brain-like. For example, they might learn a complicated feedforward function instead of tracking latent variables in a more natural way, in which case explicitly teaching the models to track variables of interest has been shown to make dynamics more brain-like (Rajalingham et al., 2022). Alternatively, the latent variables decoded could be dominated by very few neurons, thus producing “latent variables” which are not actually latent and distributed, as in the brain. This can be avoided by regularizing the state inference step to discourage sparsity, thus inferring the state from a more diverse set of neurons.\nAnother caveat to generalizing conclusions is that the proposed perturbations may be unnatural—by perturbing the latent factors decoded from passive observation, I may unwittingly by pushing neurons “off-manifold,” causing them to fire in unnatural combinations (Shenoy and Kao, 2021). While it is beyond the scope of the proposed work to avoid this, I can at least quantify the phenomenon via the proxy of neural activity unexplained by our latent dynamical, assuming our intrinsic manifold is a subspace rather than a lower-dimensional attractor structure embedded therein (Duncker and Sahani, 2021; Vyas et al., 2020). For example, if under passive observation we can predict 95% of neural activity, and that drops to 50% under perturbation, we could conclude that 45% of the activity is now unnatural, as it must be explained by dimensions of activity introduced by stimulation.\nBesides conceptual obstacles, the proposed work also has practical challenges, such as its large scale. To adequately assess control prospects across the whole space of experiment and structural factors described could represent a prohibitively high computational cost. This can be mitigated by avoiding a grid search of this space, analyzing random combinations of features or just one at a time rather than every single combination. Another factor in the computational cost is the speed of the training, model fitting, and control simulations themselves. In the case that simulations are too slow with the Brian/Cleo framework described in Aim 1, it may be worth exploring simpler simulations for the training step which does not require Cleo. This could involve using fast differential equation solvers (Rackauckas and Nie, 2017) for the training step or even a less biological learning algorithm such as backpropagation through time with surrogate gradients for the nondifferentiable spike threshold function (Zenke and Vogels, 2021). Training might also be accelerated using a form of “warm start” where weights are initialized from a pre-trained model, though care would need to be taken that the effects of the warm start on learned dynamics not overshadow those of the structural features being tested.\nAdditionally, there is a possibility that RNN-PSID requires nonlinear terms to fit model data well, despite the authors’ findings that linear dynamics are often sufficient (Sani et al., 2021b). In the case that nonlinearities preclude the formulation of MPC as a fast quadratic program, I may need to turn to neural networks, which, after training, could quickly produce approximate solutions for nonlinear optimization problems (see Section 5.5).\n\n\n\n\nAntolik J, Sabatier Q, Galle C, Frégnac Y, Benosman R. 2021. Assessment of optogenetically-driven strategies for prosthetic restoration of cortical vision in large-scale neural simulation of V1. Scientific Reports 11:1–18. doi:10.1038/s41598-021-88960-8\n\n\nAnumanchipalli GK, Chartier J, Chang EF. 2019. Speech synthesis from neural decoding of spoken sentences. Nature 568:493–498. doi:10.1038/s41586-019-1119-1\n\n\nBarack DL, Krakauer JW. 2021. Two views on the cognitive brain. Nature Reviews Neuroscience 22:359–371. doi:10.1038/s41583-021-00448-6\n\n\nBellec G, Scherr F, Subramoney A, Hajek E, Salaj D, Legenstein R, Maass W. 2020. A solution to the learning dilemma for recurrent networks of spiking neurons. Nature Communications 11. doi:10.1101/738385\n\n\nChen I-W, Papagiakoumou E, Emiliani V. 2018. Towards circuit optogenetics. Current Opinion in Neurobiology, Neurotechnologies 50:179–189. doi:10.1016/j.conb.2018.03.008\n\n\nChurchland MM, Cunningham JP, Kaufman MT, Foster JD, Nuyujukian P, Ryu SI, Shenoy KV, Shenoy KV. 2012. Neural population dynamics during reaching. Nature 487:51–56. doi:10.1038/nature11129\n\n\nChurchland MM, Cunningham JP, Kaufman MT, Ryu SI, Shenoy KV. 2010. Cortical Preparatory Activity: Representation of Movement or First Cog in a Dynamical Machine? Neuron 68:387–400. doi:10.1016/j.neuron.2010.09.015\n\n\nCunningham JP, Yu BM. 2014. Dimensionality reduction for large-scale neural recordings. Nature neuroscience 17:1500–9. doi:10.1038/nn.3776\n\n\nDriscoll L, Shenoy K, Sussillo D. 2022. Flexible multitask computation in recurrent networks utilizes shared dynamical motifs. doi:10.1101/2022.08.15.503870\n\n\nDufour S, Koninck YD. 2015. Optrodes for combined optogenetics and electrophysiology in live animals. Neurophotonics 2:031205. doi:10.1117/1.NPh.2.3.031205\n\n\nDuncker L, Sahani M. 2021. Dynamics on the manifold: Identifying computational dynamical activity from neural population recordings. Current Opinion in Neurobiology, Computational Neuroscience 70:163–170. doi:10.1016/j.conb.2021.10.014\n\n\nEriksson D, Schneider A, Thirumalai A, Alyahyay M, de la Crompe B, Sharma K, Ruther P, Diester I. 2022. Multichannel optogenetics combined with laminar recordings for ultra-controlled neuronal interrogation. Nature Communications 13:985. doi:10.1038/s41467-022-28629-6\n\n\nGallego JA, Perich MG, Miller LE, Solla SA. 2017. Neural Manifolds for the Control of Movement. Neuron 94:978–984. doi:10.1016/j.neuron.2017.05.025\n\n\nJeon S, Lee Y, Ryu D, Cho YK, Lee Y, Jun SB, Ji C-H. 2021. Implantable Optrode Array for Optogenetic Modulation and Electrical Neural Recording. Micromachines 12:725. doi:10.3390/mi12060725\n\n\nKalaska JF, Caminiti R, Georgopoulos AP. 1983. Cortical mechanisms related to the direction of two-dimensional arm movements: Relations in parietal area 5 and comparison with motor cortex. Experimental Brain Research 51:247–260. doi:10.1007/BF00237200\n\n\nKathe C, Michoud F, Schönle P, Rowald A, Brun N, Ravier J, Furfaro I, Paggi V, Kim K, Soloukey S, Asboth L, Hutson TH, Jelescu I, Philippides A, Alwahab N, Gandar J, Huber D, De Zeeuw CI, Barraud Q, Huang Q, Lacour SP, Courtine G. 2022. Wireless closed-loop optogenetics across the entire dorsoventral spinal cord in mice. Nature Biotechnology 40:198–208. doi:10.1038/s41587-021-01019-x\n\n\nKim TD, Luo TZ, Pillow JW, Brody CD. 2021. Inferring Latent Dynamics Underlying Neural Population Activity via Neural Differential EquationsProceedings of the 38th International Conference on Machine Learning. PMLR. pp. 5551–5561.\n\n\nKwon KY, Lee H-M, Ghovanloo M, Weber A, Li W. 2015. Design, fabrication, and packaging of an integrated, wirelessly-powered optrode array for optogenetics application. Frontiers in Systems Neuroscience 9.\n\n\nMao D, Li N, Xiong Z, Sun Y, Xu G. 2019. Single-Cell Optogenetic Control of Calcium Signaling with a High-Density Micro-LED Array. iScience 21:403–412. doi:10.1016/j.isci.2019.10.024\n\n\nMao D, Xiong Z, Donnelly M, Xu G. 2021. Brushing-Assisted Two-Color Quantum-Dot Micro-LED Array Towards Bi-Directional Optogenetics. IEEE Electron Device Letters 42:1504–1507. doi:10.1109/LED.2021.3108554\n\n\nMcAlinden N, Cheng Y, Scharf R, Xie E, Gu E, Reiche CF, Sharma R, Tathireddy P, Tathireddy P, Rieth L, Blair S, Mathieson K. 2019. Multisite microLED optrode array for neural interfacing. Neurophotonics 6:035010. doi:10.1117/1.NPh.6.3.035010\n\n\nMorcos AS, Harvey CD. 2016. History-dependent variability in population dynamics during evidence accumulation in cortex. Nature Neuroscience 19:1672–1681. doi:10.1038/nn.4403\n\n\nOhta Y, Guinto MC, Tokuda T, Kawahara M, Haruta M, Takehara H, Tashiro H, Sasagawa K, Onoe H, Yamaguchi R, Koshimizu Y, Isa K, Isa T, Kobayashi K, Akay YM, Akay M, Ohta J. 2021. Micro-LED Array-Based Photo-Stimulation Devices for Optogenetics in Rat and Macaque Monkey Brains. IEEE Access 9:127937–127949. doi:10.1109/ACCESS.2021.3111666\n\n\nPacker AM, Russell LE, Dalgleish HWP, Häusser M. 2015. Simultaneous all-optical manipulation and recording of neural circuit activity with cellular resolution in vivo. Nature Methods 12:140–146. doi:10.1038/nmeth.3217\n\n\nPandarinath C, O’Shea DJ, Collins J, Jozefowicz R, Stavisky SD, Kao JC, Trautmann EM, Kaufman MT, Ryu SI, Hochberg LR, Henderson JM, Shenoy KV, Abbott LF, Sussillo D. 2018. Inferring single-trial neural population dynamics using sequential auto-encoders. Nature Methods 15:805–815. doi:10.1038/s41592-018-0109-9\n\n\nPearl J. 2009. Causality. New York: Cambridge University Press. doi:10.1017/CBO9780511803161\n\n\nRackauckas C, Nie Q. 2017. DifferentialEquations.jl A Performant and Feature-Rich Ecosystem for Solving Differential Equations in Julia. Journal of Open Research Software 5:15. doi:10.5334/jors.151\n\n\nRajalingham R, Piccato A, Jazayeri M. 2022. Recurrent neural networks with explicit representation of dynamic latent variables can mimic behavioral patterns in a physical inference task. Nature Communications 13:1–15. doi:10.1038/s41467-022-33581-6\n\n\nRonzitti E, Conti R, Zampini V, Tanese D, Foust AJ, Klapoetke N, Boyden ES, Papagiakoumou E, Emiliani V. 2017. Submillisecond Optogenetic Control of Neuronal Firing with Two-Photon Holographic Photoactivation of Chronos. Journal of Neuroscience 37:10679–10689. doi:10.1523/JNEUROSCI.1246-17.2017\n\n\nSani OG, Abbaspourazad H, Wong YT, Pesaran B, Shanechi MM. 2021a. Modeling behaviorally relevant neural dynamics enabled by preferential subspace identification. Nature Neuroscience 24:140–149. doi:10.1038/s41593-020-00733-0\n\n\nSani OG, Pesaran B, Shanechi MM, Hsieh M. 2021b. Where is all the nonlinearity: Flexible nonlinear modeling of behaviorally relevant neural dynamics using recurrent neural networks. bioRxiv 2021.09.03.458628. doi:10.1101/2021.09.03.458628\n\n\nSani OG, Yang Y, Lee MB, Dawes HE, Chang EF, Shanechi MM. 2018. Mood variations decoded from multi-site intracranial human brain activity. Nature Biotechnology 36:954–961. doi:10.1038/nbt.4200\n\n\nSanthanam G, Yu BM, Gilja V, Ryu SI, Afshar A, Sahani M, Shenoy KV. 2009. Factor-Analysis Methods for Higher-Performance Neural Prostheses. Journal of Neurophysiology 102:1315–1330. doi:10.1152/jn.00097.2009\n\n\nShenoy KV, Kao JC. 2021. Measurement, manipulation and modeling of brain-wide neural population dynamics. Nature Communications 12:1–5. doi:10.1038/s41467-020-20371-1\n\n\nSmith JTH, Linderman SW, Sussillo D. 2021. Reverse engineering recurrent neural networks with Jacobian switching linear dynamical systemsAdvances in Neural Information Processing Systems. pp. 16700–16713.\n\n\nSridharan S, Gajowa MA, Ogando MB, Jagadisan UK, Abdeladim L, Sadahiro M, Bounds HA, Hendricks WD, Turney TS, Tayler I, Gopakumar K, Oldenburg IA, Brohawn SG, Adesnik H. 2022. High-performance microbial opsins for spatially and temporally precise perturbations of large neuronal networks. Neuron 110:1139–1155.e6. doi:10.1016/j.neuron.2022.01.008\n\n\nSussillo D. 2014. Neural circuits as computational dynamical systems. Current Opinion in Neurobiology, Theoretical and computational neuroscience 25:156–163. doi:10.1016/j.conb.2014.01.008\n\n\nSussillo D, Barak O. 2013. Opening the Black Box: Low-Dimensional Dynamics in High-Dimensional Recurrent Neural Networks. Neural Computation 25:626–649. doi:10.1162/NECO_a_00409\n\n\nVyas S, Golub MD, Sussillo D, Shenoy KV. 2020. Computation through Neural Population Dynamics. Annual Review of Neuroscience 43:249–275. doi:10.1146/annurev-neuro-092619-094115\n\n\nWang L, Huang K, Zhong C, Wang L, Lu Y. 2018. Fabrication and modification of implantable optrode arrays for in vivo optogenetic applications. Biophysics Reports 4:82–93. doi:10.1007/s41048-018-0052-4\n\n\nWelkenhuysen M, Hoffman L, Luo Z, De Proft A, Van den Haute C, Baekelandt V, Debyser Z, Gielen G, Puers R, Braeken D. 2016. An integrated multi-electrode-optrode array for in vitro optogenetics. Scientific Reports 6:20353. doi:10.1038/srep20353\n\n\nWillett FR, Avansino DT, Hochberg LR, Henderson JM, Shenoy KV. 2021. High-performance brain-to-text communication via handwriting. Nature 593:249–254. doi:10.1038/s41586-021-03506-2\n\n\nYang GR, Joglekar MR, Song HF, Newsome WT, Wang X-J. 2019. Task representations in neural networks trained to perform many cognitive tasks. Nature Neuroscience 22:297–306. doi:10.1038/s41593-018-0310-2\n\n\nZenke F, Vogels TP. 2021. The Remarkable Robustness of Surrogate Gradient Learning for Instilling Complex Function in Spiking Neural Networks. Neural Computation 33:899–925. doi:10.1162/neco_a_01367\n\n\nZhang Z, Russell LE, Packer AM, Gauld OM, Häusser M. 2018. Closed-loop all-optical interrogation of neural circuits in vivo. Nature Methods 15:1037–1040. doi:10.1038/s41592-018-0183-z"
  },
  {
    "objectID": "src/timeline.html",
    "href": "src/timeline.html",
    "title": "7  Proposed timeline",
    "section": "",
    "text": "%%{ init: {'fontFamily': 'Source Sans Pro, Open Sans, trebuchet ms, Arial, sans-serif'}}%%\ngantt\n    dateFormat  YYYY-MM-DD\n    axisFormat  %b '%y\n    %% title       Proposed timeline\n    excludes    weekends\n    %% (`excludes` accepts specific dates in YYYY-MM-DD format, days of the week (\"sunday\") or \"weekends\", but not the word \"weekdays\".)\n\n    section Aim 1\n    edit paper            :active, a1edit, 2023-01-01, 2w\n    submission to eLife :milestone, a1submit, after a1edit, 3d\n    wait for review  :done, a1wait, after a1submit, 8w\n    paper revisions :a1revise, after a1wait, 6w\n\n    section Aim 2\n    %% refine control code :a2code, after f31, 4w\n    %% add multi-input opto to Cleo :a2multi, after a2code, 2w\n    design and run simulations :a2run, after f31, 10w\n    analyze results :a2analyze, after a2run a1revise intern, 4w\n    write paper :a2paper, after a2analyze, 8w\n    submission to JNE :milestone, a2submit, after a2paper, 3d\n    wait for review  :done, a2wait, after a2submit, 8w\n    paper revisions :a2revise, after a3train a2wait, 4w\n\n    section Aim 3\n    %% set up project infrastructure :a3infra, after a2submit, 4w\n    configure and train RSNN models : a3train, after a2submit, 12w\n    %% configure system ID and control methods :a3sysctrl, after a3train a2revise, 6w\n    perform system ID and control experiments :a3expt, after a3train a2revise, 9w\n    analyze data :a3analyze, after a3expt, 3w\n    write paper :a3paper, after a3analyze, 8w\n    submission to Nat. Neuro :milestone, a3submit, after a3paper, 3d\n\n\n    section Other\n    F31 submission :f31, after a1submit, 4w\n    possible internship :intern, 2023-05-01, 12w\n    prepare dissertation :prep, after a3submit, 8w\n    defend :milestone, after prep, 2d"
  },
  {
    "objectID": "src/references.html",
    "href": "src/references.html",
    "title": "References",
    "section": "",
    "text": "Adesnik H, Abdeladim L. 2021. Probing neural codes with two-photon\nholographic optogenetics. Nature Neuroscience\n24:1356–1366. doi:10.1038/s41593-021-00902-9\n\n\nAkam T, Kullmann DM. 2014. Oscillatory multiplexing of population codes\nfor selective communication in the mammalian brain. Nature Reviews\nNeuroscience 15:111–122. doi:10.1038/nrn3668\n\n\nAlegria A, Joshi A, O’Brien J, Kodandaramaiah SB. 2020. Single neuron\nrecording: Progress towards high-throughput analysis. Bioelectronics\nin Medicine 3:33–36. doi:10.2217/bem-2020-0011\n\n\nAntolik J, Sabatier Q, Galle C, Frégnac Y, Benosman R. 2021. Assessment\nof optogenetically-driven strategies for prosthetic restoration of\ncortical vision in large-scale neural simulation of V1.\nScientific Reports 11:1–18. doi:10.1038/s41598-021-88960-8\n\n\nAnumanchipalli GK, Chartier J, Chang EF. 2019. Speech synthesis from\nneural decoding of spoken sentences. Nature\n568:493–498. doi:10.1038/s41586-019-1119-1\n\n\nAru J, Aru J, Priesemann V, Wibral M, Lana L, Pipa G, Singer W, Vicente\nR. 2015. Untangling cross-frequency coupling in neuroscience.\nCurrent Opinion in Neurobiology 31:51–61.\ndoi:10.1016/j.conb.2014.08.002\n\n\nAussel A, Buhry L, Tyvaert L, Ranta R. 2018. A detailed anatomical and\nmathematical model of the hippocampal formation for the generation of\nsharp-wave ripples and theta-nested gamma oscillations. Journal of\nComputational Neuroscience 45:207–221. doi:10.1007/s10827-018-0704-x\n\n\nAussel A, Ranta R, Aron O, Colnat-Coulbois S, Maillard L, Buhry L. 2022.\nCell to network computational model of the epileptic human hippocampus\nsuggests specific roles of network and channel dysfunctions in the ictal\nand interictal oscillations. Journal of Computational\nNeuroscience. doi:10.1007/s10827-022-00829-5\n\n\nAvitan L, Stringer C. 2022. Not so spontaneous: Multi-dimensional representations of behaviors and\ncontext in sensory areas. Neuron. doi:10.1016/j.neuron.2022.06.019\n\n\nBansal H, Gupta N, Roy S. 2021. Theoretical analysis of optogenetic\nspiking with ChRmine, bReaChES\nand CsChrimson-expressing neurons for\nretinal prostheses. Journal of Neural Engineering\n18:0460b8. doi:10.1088/1741-2552/ac1175\n\n\nBansal H, Gupta N, Roy S. 2020a. Theoretical Analysis of\nLow-power Bidirectional Optogenetic Control\nof High-frequency Neural Codes with\nSingle Spike Resolution. Neuroscience\n449:165–188. doi:10.1016/j.neuroscience.2020.09.022\n\n\nBansal H, Gupta N, Roy S. 2020b. Comparison of low-power, high-frequency\nand temporally precise optogenetic inhibition of spiking in\nNpHR, eNpHR3.0 and Jaws-expressing neurons. Biomedical Physics\nand Engineering Express 6:045011. doi:10.1088/2057-1976/ab90a1\n\n\nBarack DL, Krakauer JW. 2021. Two views on the cognitive brain.\nNature Reviews Neuroscience 22:359–371. doi:10.1038/s41583-021-00448-6\n\n\nBellec G, Scherr F, Subramoney A, Hajek E, Salaj D, Legenstein R, Maass\nW. 2020. A solution to the learning dilemma for recurrent networks of\nspiking neurons. Nature Communications 11.\ndoi:10.1101/738385\n\n\nBemporad A, Morari M, Dua V, Pistikopoulos EN. 2002. The explicit linear\nquadratic regulator for constrained systems. Automatica\n38:3–20. doi:10.1016/S0005-1098(01)00174-1\n\n\nBerman GJ, Choi DM, Bialek W, Shaevitz JW. 2014. Mapping the stereotyped\nbehaviour of freely moving fruit flies. Journal of The Royal Society\nInterface 11:20140672. doi:10.1098/rsif.2014.0672\n\n\nBerndt A, Lee SY, Wietek J, Ramakrishnan C, Steinberg EE, Rashid AJ, Kim\nH, Park S, Santoro A, Frankland PW, Iyer SM, Pak S, Ährlund-Richter S,\nDelp SL, Malenka RC, Josselyn SA, Carlén M, Hegemann P, Deisseroth K.\n2016. Structural foundations of optogenetics: Determinants\nof channelrhodopsin ion selectivity. Proceedings of the National\nAcademy of Sciences of the United States of America\n113:822–829. doi:10.1073/pnas.1523341113\n\n\nBogdanchikov A, Zhaparov M, Suliyev R. 2013. Python to learn\nprogrammingJournal of Physics: Conference\nSeries. IOP Publishing. p. 012027. doi:10.1088/1742-6596/423/1/012027\n\n\nBolus MF, Willats AA, Rozell CJ, Stanley GB. 2021. State-space optimal\nfeedback control of optogenetically driven neural activity. Journal\nof neural engineering 18:036006. doi:10.1101/2020.06.25.171785\n\n\nBolus MF, Willats AA, Whitmire CJ, Rozell CJ, Stanley GB. 2018. Design\nstrategies for dynamic closed-loop optogenetic neurocontrol in vivo.\nJournal of Neural Engineering 15:026011.\ndoi:10.1088/1741-2552/aaa506\n\n\nBrunel N, Wang X-J. 2003. What determines the frequency of fast network\noscillations with irregular neural discharges? I.\nSynaptic dynamics and excitation-inhibition balance.\nJournal of neurophysiology 90:415–430.\n\n\nBuffalo EA, Fries P, Landman R, Buschman TJ, Desimone R. 2011. Laminar\ndifferences in gamma and alpha coherence in the ventral stream.\nProceedings of the National Academy of Sciences of the United States\nof America 108:11262–11267. doi:10.1073/pnas.1011284108\n\n\nBuschman TJ, Denovellis EL, Diogo C, Bullock D, Miller EK. 2012.\nSynchronous Oscillatory Neural Ensembles for\nRules in the Prefrontal Cortex.\nNeuron 76:838–846. doi:10.1016/j.neuron.2012.09.029\n\n\nBuzsáki G. 2015. Hippocampal sharp wave-ripple: A cognitive\nbiomarker for episodic memory and planning. Hippocampus\n25:1073–1188. doi:10.1002/hipo.22488\n\n\nBuzsáki G, Anastassiou CA, Koch C. 2012. The origin of extracellular\nfields and currents EEG, ECoG,\nLFP and spikes. Nature Reviews Neuroscience 2012\n13:6 13:407–420. doi:10.1038/nrn3241\n\n\nBuzsáki G, Draguhn A. 2004. Neuronal oscillations in cortical networks.\nScience 304:1926–1929. doi:10.1126/science.1099745\n\n\nBuzsáki G, Wang X-J. 2012. Mechanisms of Gamma\nOscillations. Annual Review of Neuroscience\n35:203–225. doi:10.1146/annurev-neuro-062111-150444\n\n\nCardin JA, Carlén M, Meletis K, Knoblich U, Zhang F, Deisseroth K, Tsai\nLH, Moore CI. 2010. Targeted optogenetic stimulation and recording of\nneurons in vivo using cell-type-specific expression of\nChannelrhodopsin-2. Nature Protocols\n5:247–254. doi:10.1038/nprot.2009.228\n\n\nChen I-W, Papagiakoumou E, Emiliani V. 2018. Towards circuit\noptogenetics. Current Opinion in Neurobiology,\nNeurotechnologies 50:179–189. doi:10.1016/j.conb.2018.03.008\n\n\nChen S, Weitemier AZ, Zeng X, He L, Wang X, Tao Y, Huang AJY,\nHashimotodani Y, Kano M, Iwasaki H, Parajuli LK, Okabe S, Loong Teh DB,\nAll AH, Tsutsui-Kimura I, Tanaka KF, Liu X, McHugh TJ. 2018.\nNear-infrared deep brain stimulation via upconversion\nnanoparticlemediated optogenetics. Science\n359:679–684. doi:10.1126/science.aaq1144\n\n\nChuong AS, Miri ML, Busskamp V, Matthews GAC, Acker LC, Sørensen AT,\nYoung A, Klapoetke NC, Henninger MA, Kodandaramaiah SB, Ogawa M,\nRamanlal SB, Bandler RC, Allen BD, Forest CR, Chow BY, Han X, Lin Y, Tye\nKM, Roska B, Cardin JA, Boyden ES. 2014. Noninvasive optical inhibition\nwith a red-shifted microbial rhodopsin. Nature Neuroscience\n17:1123–1129. doi:10.1038/nn.3752\n\n\nChurchland MM, Cunningham JP, Kaufman MT, Foster JD, Nuyujukian P, Ryu\nSI, Shenoy KV, Shenoy KV. 2012. Neural population dynamics during\nreaching. Nature 487:51–56. doi:10.1038/nature11129\n\n\nChurchland MM, Cunningham JP, Kaufman MT, Ryu SI, Shenoy KV. 2010.\nCortical Preparatory Activity: Representation\nof Movement or First Cog in a Dynamical\nMachine? Neuron 68:387–400. doi:10.1016/j.neuron.2010.09.015\n\n\nCole SR, Voytek B. 2017. Brain Oscillations and the\nImportance of Waveform Shape. Trends in\nCognitive Sciences 21:137–149. doi:10.1016/j.tics.2016.12.008\n\n\nCole S, Voytek B. 2019. Cycle-by-cycle analysis of neural oscillations.\nJournal of Neurophysiology 122:849–861. doi:10.1152/JN.00273.2019\n\n\nCowley BR, Snyder AC, Acar K, Williamson RC, Yu BM, Smith MA. 2020. Slow\nDrift of Neural Activity as a\nSignature of Impulsivity in Macaque\nVisual and Prefrontal Cortex. Neuron\n108:551–567.e8. doi:10.1016/j.neuron.2020.07.021\n\n\nCunningham JP, Yu BM. 2014. Dimensionality reduction for large-scale\nneural recordings. Nature neuroscience\n17:1500–9. doi:10.1038/nn.3776\n\n\nDavie JT, Kole MHP, Letzkus JJ, Rancz EA, Spruston N, Stuart GJ, Häusser\nM. 2006. Dendritic patch-clamp recording. Nature Protocols\n1:1235–1247. doi:10.1038/nprot.2006.164\n\n\nDavis ZW, Muller L, Martinez-Trujillo J, Sejnowski T, Reynolds JH. 2020.\nSpontaneous travelling cortical waves gate perception in behaving\nprimates. Nature 587:432–436. doi:10.1038/s41586-020-2802-y\n\n\nDavison AP, Hines ML, Muller E. 2009. Trends in programming languages\nfor neuroscience simulations. Frontiers in Neuroscience\n3:374–380. doi:10.3389/neuro.01.036.2009\n\n\nDriscoll L, Shenoy K, Sussillo D. 2022. Flexible multitask computation\nin recurrent networks utilizes shared dynamical motifs. doi:10.1101/2022.08.15.503870\n\n\nDufour S, Koninck YD. 2015. Optrodes for combined optogenetics and\nelectrophysiology in live animals. Neurophotonics\n2:031205. doi:10.1117/1.NPh.2.3.031205\n\n\nDuncker L, Sahani M. 2021. Dynamics on the manifold:\nIdentifying computational dynamical activity from neural\npopulation recordings. Current Opinion in Neurobiology,\nComputational Neuroscience 70:163–170.\ndoi:10.1016/j.conb.2021.10.014\n\n\nDutta S, Ackermann E, Kemere C. 2019. Analysis of an open source,\nclosed-loop, realtime system for hippocampal sharp-wave ripple\ndisruption. Journal of Neural Engineering\n16:016009. doi:10.1088/1741-2552/aae90e\n\n\nEmiliani V, Cohen AE, Deisseroth K, Häusser M. 2015. All-optical\ninterrogation of neural circuits. Journal of Neuroscience\n35:13917–13926. doi:10.1523/JNEUROSCI.2916-15.2015\n\n\nEngel D. 2016. Subcellular patch-clamp recordings from the\nsomatodendritic domain of nigral dopamine neurons. Journal of\nVisualized Experiments 2016:e54601. doi:10.3791/54601\n\n\nEriksson D, Schneider A, Thirumalai A, Alyahyay M, de la Crompe B,\nSharma K, Ruther P, Diester I. 2022. Multichannel optogenetics combined\nwith laminar recordings for ultra-controlled neuronal interrogation.\nNature Communications 13:985. doi:10.1038/s41467-022-28629-6\n\n\nEvans BD, Jarvis S, Schultz SR, Nikolic K. 2016. PyRhO:\nA Multiscale Optogenetics Simulation Platform.\nFrontiers in Neuroinformatics 10:8. doi:10.3389/fninf.2016.00008\n\n\nFabus MS, Quinn AJ, Warnaby CE, Woolrich MW. 2021. Automatic\ndecomposition of electrophysiological data into distinct nonsinusoidal\noscillatory modes. Journal of Neurophysiology\n126:1670–1684. doi:10.1152/jn.00315.2021\n\n\nFaini G, Molinier C, Telliez C, Tourain C, Forget BC, Ronzitti E,\nEmiliani V. 2021. Ultrafast Light Targeting for\nHigh-Throughput Precise Control of Neuronal\nNetworks. bioRxiv 2021.06.14.448315. doi:10.1101/2021.06.14.448315\n\n\nFenno L, Yizhar O, Deisseroth K. 2011. The development and application\nof optogenetics. Annual Review of Neuroscience\n34:389–412. doi:10.1146/annurev-neuro-061010-113817\n\n\nFernandez LMJ, Lüthi A. 2020. Sleep Spindles:\nMechanisms and Functions. Physiological\nReviews 100:805–868. doi:10.1152/physrev.00042.2018\n\n\nFlytzanis NC, Bedbrook CN, Chiu H, Engqvist MKM, Xiao C, Chan KY,\nSternberg PW, Arnold FH, Gradinaru V. 2014. Archaerhodopsin variants\nwith enhanced voltage-sensitive fluorescence in mammalian and\nCaenorhabditis elegans neurons. Nature\nCommunications 5:4894. doi:10.1038/ncomms5894\n\n\nFoutz TJ, Arlow RL, Mcintyre CC. 2012. Theoretical principles underlying\noptical stimulation of a channelrhodopsin-2 positive pyramidal neuron.\nJ Neurophysiol 107:3235–3245. doi:10.1152/jn.00501.2011.-Optogenetics\n\n\nGallego JA, Perich MG, Miller LE, Solla SA. 2017. Neural\nManifolds for the Control of\nMovement. Neuron 94:978–984.\ndoi:10.1016/j.neuron.2017.05.025\n\n\nGerstner W, Kistler WM, Naud R, Paninski L. 2014. Neuronal dynamics:\nFrom single neurons to networks and models of cognition,\nNeuronal Dynamics: From Single Neurons to Networks and Models of\nCognition. Cambridge University Press. doi:10.1017/CBO9781107447615\n\n\nGöbel W, Helmchen F. 2007. In Vivo Calcium Imaging of\nNeural Network Function. Physiology\n22:358–365. doi:10.1152/physiol.00032.2007\n\n\nGovorunova EG, Sineshchekov OA, Janz R, Liu X, Spudich JL. 2015. Natural\nlight-gated anion channels: A family of microbial\nrhodopsins for advanced optogenetics. Science\n349:647–650. doi:10.1126/science.aaa7484\n\n\nGovorunova EG, Sineshchekov OA, Rodarte EM, Janz R, Morelle O, Melkonian\nM, Wong GKS, Spudich JL. 2017. The Expanding Family of\nNatural Anion Channelrhodopsins Reveals Large Variations in\nKinetics, Conductance, and Spectral\nSensitivity. Scientific Reports 7:1–10.\ndoi:10.1038/srep43358\n\n\nGradinaru V, Zhang F, Ramakrishnan C, Mattis J, Prakash R, Diester I,\nGoshen I, Thompson KR, Deisseroth K. 2010. Molecular and Cellular\nApproaches for Diversifying and Extending\nOptogenetics. Cell 141:154–165. doi:10.1016/j.cell.2010.02.037\n\n\nGrosenick L, Marshel JH, Deisseroth K. 2015. Review\nClosed-Loop and Activity-Guided Optogenetic\nControl. Neuron 86:106–139. doi:10.1016/j.neuron.2015.03.034\n\n\nGunaydin LA, Yizhar O, Berndt A, Sohal VS, Deisseroth K, Hegemann P.\n2010. Ultrafast optogenetic control. Nature Neuroscience\n13:387–392. doi:10.1038/nn.2495\n\n\nGupta N, Bansal H, Roy S. 2019. Theoretical optimization of\nhigh-frequency optogenetic spiking of red-shifted very fast-Chrimson-expressing neurons.\nNeurophotonics 6:1. doi:10.1117/1.nph.6.2.025002\n\n\nGutruf P, Rogers JA. 2018. Implantable, wireless device platforms for\nneuroscience research. Current Opinion in Neurobiology,\nNeurotechnologies 50:42–49. doi:10.1016/j.conb.2017.12.007\n\n\nHagen E, Næss S, Ness TV, Einevoll GT. 2018. Multimodal modeling of\nneural network activity: Computing LFP, ECoG,\nEEG, and MEG signals with LFPy\n2.0. Frontiers in Neuroinformatics 12:92.\ndoi:10.3389/fninf.2018.00092\n\n\nHochbaum DR, Zhao Y, Farhi SL, Klapoetke N, Werley CA, Kapoor V, Zou P,\nKralj JM, MacLaurin D, Smedemark-Margulies N, Saulnier JL, Boulting GL,\nStraub C, Cho YK, Melkonian M, Wong GKS, Harrison DJ, Murthy VN,\nSabatini BL, Boyden ES, Campbell RE, Cohen AE. 2014. All-optical\nelectrophysiology in mammalian neurons using engineered microbial\nrhodopsins. Nature Methods 11:825–833. doi:10.1038/NMETH.3000\n\n\nHodgkin AL, Huxley AF, Katz B. 1952. Measurement\nof current-voltage relations in the membrane of the giant axon of\nLoligo. The Journal of Physiology\n116:424–448.\n\n\nHolt GR, Koch C. 1999. Electrical interactions via the extracellular\npotential near cell bodies. Journal of Computational\nNeuroscience 6:169–184. doi:10.1023/A:1008832702585\n\n\nHurwitz C, Srivastava A, Xu K, Jude J, Perich MG, Miller LE, Hennig MH.\n2021. Targeted Neural\nDynamical ModelingAdvances in Neural Information\nProcessing Systems. pp. 29379–29392.\n\n\nInoue M. 2021. Genetically encoded calcium indicators to probe complex\nbrain circuit dynamics in vivo. Neuroscience Research\n169:2–8. doi:10.1016/j.neures.2020.05.013\n\n\nJazayeri M, Ostojic S. 2021. Interpreting neural computations by\nexamining intrinsic and embedding dimensionality of neural activity.\nCurrent Opinion in Neurobiology 70:113–120.\ndoi:10.1016/j.conb.2021.08.002\n\n\nJeon S, Lee Y, Ryu D, Cho YK, Lee Y, Jun SB, Ji C-H. 2021. Implantable\nOptrode Array for Optogenetic Modulation and\nElectrical Neural Recording. Micromachines\n12:725. doi:10.3390/mi12060725\n\n\nJoglekar A, Prjibelski A, Mahfouz A, Collier P, Lin S, Schlusche AK,\nMarrocco J, Williams SR, Haase B, Hayes A, Chew JG, Weisenfeld NI, Wong\nMY, Stein AN, Hardwick SA, Hunt T, Wang Q, Dieterich C, Bent Z, Fedrigo\nO, Sloan SA, Risso D, Jarvis ED, Flicek P, Luo W, Pitt GS, Frankish A,\nSmit AB, Ross ME, Tilgner HU. 2021. A spatially resolved brain region-\nand cell type-specific isoform atlas of the postnatal mouse brain.\nNature Communications 12:463. doi:10.1038/s41467-020-20343-5\n\n\nJohnsen K. 2022. Kjohnsen/tklfp: V0.2.0. doi:10.5281/zenodo.6787979\n\n\nJuavinett AL, Bekheet G, Churchland AK. 2019. Chronically implanted\nNeuropixels probes enable high-yield recordings in freely\nmoving mice. eLife 8:e47188. doi:10.7554/eLife.47188\n\n\nKalaska JF, Caminiti R, Georgopoulos AP. 1983. Cortical mechanisms\nrelated to the direction of two-dimensional arm movements: Relations in\nparietal area 5 and comparison with motor cortex. Experimental Brain\nResearch 51:247–260. doi:10.1007/BF00237200\n\n\nKalman RE. 1960. A new approach to linear filtering and prediction\nproblems. Journal of Fluids Engineering, Transactions of the\nASME 82:35–45. doi:10.1115/1.3662552\n\n\nKarvat G, Schneider A, Alyahyay M, Steenbergen F, Tangermann M, Diester\nI. 2020. Real-time detection of neural oscillation bursts allows\nbehaviourally relevant neurofeedback. Communications Biology\n3:1–10. doi:10.1038/s42003-020-0801-z\n\n\nKathe C, Michoud F, Schönle P, Rowald A, Brun N, Ravier J, Furfaro I,\nPaggi V, Kim K, Soloukey S, Asboth L, Hutson TH, Jelescu I, Philippides\nA, Alwahab N, Gandar J, Huber D, De Zeeuw CI, Barraud Q, Huang Q, Lacour\nSP, Courtine G. 2022. Wireless closed-loop optogenetics across the\nentire dorsoventral spinal cord in mice. Nature Biotechnology\n40:198–208. doi:10.1038/s41587-021-01019-x\n\n\nKaufman MT, Churchland MM, Ryu SI, Shenoy KV. 2014. Cortical activity in\nthe null space: Permitting preparation without movement.\nNature Neuroscience 17:440–448. doi:10.1038/nn.3643\n\n\nKazemipour A, Novak O, Flickinger D, Marvin JS, Abdelfattah AS, King J,\nBorden PM, Kim JJ, Al-Abdullatif SH, Deal PE, Miller EW, Schreiter ER,\nDruckmann S, Svoboda K, Looger LL, Podgorski K. 2019. Kilohertz\nframe-rate two-photon tomography. Nature Methods\n16:778–786. doi:10.1038/s41592-019-0493-9\n\n\nKim TD, Luo TZ, Pillow JW, Brody CD. 2021. Inferring Latent\nDynamics Underlying Neural Population Activity via Neural\nDifferential EquationsProceedings of the 38th International\nConference on Machine Learning. PMLR.\npp. 5551–5561.\n\n\nKishi KE, Kim YS, Fukuda M, Inoue M, Kusakizako T, Wang PY, Ramakrishnan\nC, Byrne EFX, Thadhani E, Paggi JM, Matsui TE, Yamashita K, Nagata T,\nKonno M, Quirin S, Lo M, Benster T, Uemura T, Liu K, Shibata M, Nomura\nN, Iwata S, Nureki O, Dror RO, Inoue K, Deisseroth K, Kato HE. 2022.\nStructural basis for channel conduction in the pump-like\nchannelrhodopsin ChRmine. Cell\n185:672–689.e23. doi:10.1016/j.cell.2022.01.007\n\n\nKlapoetke NC, Murata Y, Kim SS, Pulver SR, Birdsey-Benson A, Cho YK,\nMorimoto TK, Chuong AS, Carpenter EJ, Tian Z, Wang J, Xie Y, Yan Z,\nZhang Y, Chow BY, Surek B, Melkonian M, Jayaraman V, Constantine-Paton\nM, Wong GKS, Boyden ES. 2014. Independent optical excitation of distinct\nneural populations. Nature Methods 11:338–346.\ndoi:10.1038/nmeth.2836\n\n\nKnöpfel T, Song C. 2019. Optical voltage imaging in neurons: Moving from\ntechnology development to practical tool. Nature Reviews\nNeuroscience 20:719–727. doi:10.1038/s41583-019-0231-4\n\n\nKokaia M, Andersson M, Ledri M. 2013. An optogenetic approach in\nepilepsy. Neuropharmacology 69:89–95. doi:10.1016/j.neuropharm.2012.05.049\n\n\nKrook-Magnuson E, Armstrong C, Oijala M, Soltesz I. 2013. On-demand\noptogenetic control of spontaneous seizures in temporal lobe epilepsy.\nNature Communications 4:1–8. doi:10.1038/ncomms2376\n\n\nKumar A, Vlachos I, Aertsen A, Boucsein C. 2013. Challenges of\nunderstanding brain function by selective modulation of neuronal\nsubpopulations. Trends in Neurosciences\n36:579–586. doi:10.1016/j.tins.2013.06.005\n\n\nKwon KY, Lee H-M, Ghovanloo M, Weber A, Li W. 2015. Design, fabrication,\nand packaging of an integrated, wirelessly-powered optrode array for\noptogenetics application. Frontiers in Systems Neuroscience\n9.\n\n\nLee C, Lavoie A, Liu J, Chen SX, Liu B. 2020. Light Up the\nBrain: The Application of\nOptogenetics in Cell-Type Specific Dissection\nof Mouse Brain Circuits. Frontiers in Neural\nCircuits 14.\n\n\nLin JY, Knutsen PM, Muller A, Kleinfeld D, Tsien RY. 2013.\nReaChR: A red-shifted variant of\nchannelrhodopsin enables deep transcranial optogenetic excitation.\nNature Neuroscience 16:1499–1508. doi:10.1038/nn.3502\n\n\nLundqvist M, Rose J, Brincat SL, Warden MR, Buschman TJ, Herman P,\nMiller EK. 2022. Reduced variability of bursting activity during working\nmemory. Scientific Reports 12:15050. doi:10.1038/s41598-022-18577-y\n\n\nLundqvist M, Rose J, Herman P, Brincat SLL, Buschman TJJ, Miller EKK.\n2016. Gamma and Beta Bursts Underlie Working Memory.\nNeuron 90:152–164. doi:10.1016/j.neuron.2016.02.028\n\n\nMaaten L van der, Hinton G. 2008. Visualizing Data using\nt-SNE. Journal of Machine Learning Research\n9:2579–2605.\n\n\nMacke JH, Buesing L, Cunningham JP, Yu BM, Shenoy KV, Sahani M. 2011.\nEmpirical models of spiking in neural populationsAdvances in\nNeural Information Processing Systems. Curran\nAssociates, Inc.\n\n\nMager T, Morena DLDL, Senn V, Schlotte J, Derrico A, Feldbauer K, Wrobel\nC, Jung S, Bodensiek K, Rankovic V, Browne L, Huet A, Jüttner J, Wood\nPG, Letzkus JJ, Moser T, Bamberg E. 2018. High frequency neural spiking\nand auditory signaling by ultrafast red-shifted optogenetics. Nature\nCommunications 9:1–14. doi:10.1038/s41467-018-04146-3\n\n\nMao D, Li N, Xiong Z, Sun Y, Xu G. 2019. Single-Cell Optogenetic\nControl of Calcium Signaling with a\nHigh-Density Micro-LED Array. iScience\n21:403–412. doi:10.1016/j.isci.2019.10.024\n\n\nMao D, Xiong Z, Donnelly M, Xu G. 2021. Brushing-Assisted\nTwo-Color Quantum-Dot Micro-LED Array Towards Bi-Directional\nOptogenetics. IEEE Electron Device Letters\n42:1504–1507. doi:10.1109/LED.2021.3108554\n\n\nMartinez-Garcia RI, Voelcker B, Zaltsman JB, Patrick SL, Stevens TR,\nConnors BW, Cruikshank SJ. 2020. Two dynamically distinct circuits drive\ninhibition in the sensory thalamus. Nature\n583:813–818. doi:10.1038/s41586-020-2512-5\n\n\nMathis A, Mamidanna P, Cury KM, Abe T, Murthy VN, Mathis MW, Bethge M.\n2018. DeepLabCut: Markerless pose estimation of\nuser-defined body parts with deep learning. Nature Neuroscience\n21:1281–1289. doi:10.1038/s41593-018-0209-y\n\n\nMazzoni A, Lindén H, Cuntz H, Lansner A, Panzeri S, Einevoll GT. 2015.\nComputing the Local Field Potential (LFP) from\nIntegrate-and-Fire Network Models. PLOS\nComputational Biology 11:e1004584. doi:10.1371/JOURNAL.PCBI.1004584\n\n\nMcAlinden N, Cheng Y, Scharf R, Xie E, Gu E, Reiche CF, Sharma R,\nTathireddy P, Tathireddy P, Rieth L, Blair S, Mathieson K. 2019.\nMultisite microLED optrode array for neural\ninterfacing. Neurophotonics 6:035010. doi:10.1117/1.NPh.6.3.035010\n\n\nMoldakarimov S, Bazhenov M, Feldman DE, Sejnowski TJ. 2018. Structured\nnetworks support sparse traveling waves in rodent somatosensory cortex.\nProceedings of the National Academy of Sciences of the United States\nof America 115:5277–5282. doi:10.1073/pnas.1710202115\n\n\nMorcos AS, Harvey CD. 2016. History-dependent variability in population\ndynamics during evidence accumulation in cortex. Nature\nNeuroscience 19:1672–1681. doi:10.1038/nn.4403\n\n\nMukamel EA, Ngai J. 2019. Perspectives on defining cell types in the\nbrain. Current Opinion in Neurobiology, Neuronal\nIdentity 56:61–68. doi:10.1016/j.conb.2018.11.007\n\n\nMuller E, Bednar JA, Diesmann M, Gewaltig MO, Hines M, Davison AP. 2015.\nPython in neuroscience. Frontiers in Neuroinformatics\n9:11. doi:10.3389/fninf.2015.00011\n\n\nMuller L, Chavane F, Reynolds J, Sejnowski TJ. 2018. Cortical travelling\nwaves: Mechanisms and computational principles. Nature\nReviews Neuroscience 19:255–268. doi:10.1038/nrn.2018.20\n\n\nNason SR, Vaskov AK, Willsey MS, Welle EJ, An H, Vu PP, Bullard AJ, Nu\nCS, Kao JC, Shenoy KV, Jang T, Kim H-S, Blaauw D, Patil PG, Chestek CA.\n2020. A low-power band of neuronal spiking activity dominated by local\nsingle units improves the performance of brainmachine interfaces.\nNature Biomedical Engineering 2020 1–11. doi:10.1038/s41551-020-0591-0\n\n\nNěmec P, Osten P. 2020. The evolution of brain structure captured in\nstereotyped cell count and cell type distributions. Current Opinion\nin Neurobiology, Neurobiology of Behavior\n60:176–183. doi:10.1016/j.conb.2019.12.005\n\n\nNewman JP, Fong MF, Millard DC, Whitmire CJ, Stanley GB, Potter SM.\n2015. Optogenetic feedback control of neural activity. eLife.\ndoi:10.7554/eLife.07192\n\n\nNewman J, Zeller-Townson R, Fong M, Arcot Desai S, Gross R, Potter S.\n2013. Closed-Loop, Multichannel Experimentation\nUsing the Open-Source NeuroRighter Electrophysiology\nPlatform. Frontiers in Neural Circuits\n6.\n\n\nOby ER, Golub MD, Hennig JA, Degenhart AD, Tyler-Kabara EC, Yu BM, Chase\nSM, Batista AP. 2019. New neural activity patterns emerge with long-term\nlearning. Proceedings of the National Academy of Sciences\n116:15210–15215. doi:10.1073/pnas.1820296116\n\n\nOhta Y, Guinto MC, Tokuda T, Kawahara M, Haruta M, Takehara H, Tashiro\nH, Sasagawa K, Onoe H, Yamaguchi R, Koshimizu Y, Isa K, Isa T, Kobayashi\nK, Akay YM, Akay M, Ohta J. 2021. Micro-LED Array-Based\nPhoto-Stimulation Devices for Optogenetics in\nRat and Macaque Monkey Brains. IEEE\nAccess 9:127937–127949. doi:10.1109/ACCESS.2021.3111666\n\n\nPacker AM, Roska B, Häuser M. 2013. Targeting neurons and photons for\noptogenetics. Nature Neuroscience 16:805–815.\ndoi:10.1038/nn.3427\n\n\nPacker AM, Russell LE, Dalgleish HWP, Häusser M. 2015. Simultaneous\nall-optical manipulation and recording of neural circuit activity with\ncellular resolution in vivo. Nature Methods\n12:140–146. doi:10.1038/nmeth.3217\n\n\nPandarinath C, O’Shea DJ, Collins J, Jozefowicz R, Stavisky SD, Kao JC,\nTrautmann EM, Kaufman MT, Ryu SI, Hochberg LR, Henderson JM, Shenoy KV,\nAbbott LF, Sussillo D. 2018. Inferring single-trial neural population\ndynamics using sequential auto-encoders. Nature Methods\n15:805–815. doi:10.1038/s41592-018-0109-9\n\n\nParasuram H, Nair B, D’Angelo E, Hines M, Naldi G, Diwakar S. 2016.\nComputational modeling of single neuron extracellular electric\npotentials and network local field potentials using LFPsim.\nFrontiers in Computational Neuroscience 10:65.\ndoi:10.3389/fncom.2016.00065\n\n\nPearl J. 2009. Causality. New York: Cambridge\nUniversity Press. doi:10.1017/CBO9780511803161\n\n\nPeixoto D, Verhein JR, Kiani R, Kao JC, Nuyujukian P, Chandrasekaran C,\nBrown J, Fong S, Ryu SI, Shenoy KV, Newsome WT. 2021. Decoding and\nperturbing decision states in real time. Nature\n591:604–609. doi:10.1038/s41586-020-03181-9\n\n\nPeng Y, Mittermaier FX, Planert H, Schneider UC, Alle H, Geiger JRP.\n2019. High-throughput microcircuit analysis of individual human brains\nthrough next-generation multineuron patch-clamp. eLife\n8:e48178. doi:10.7554/eLife.48178\n\n\nPettersen KH, Lindén H, Dale AM, Einevoll GT. 2012. Extracellular spikes\nand CSD. Handbook of neural activity measurement\n1:92–135.\n\n\nPotter SM, El Hady A, Fetz EE. 2014. Closed-loop neuroscience and\nneuroengineering. Frontiers in Neural Circuits\n0:115. doi:10.3389/FNCIR.2014.00115\n\n\nPrinz AA, Abbott LF, Marder E. 2004. The dynamic clamp comes of age.\nTrends in Neurosciences 27:218–224. doi:10.1016/j.tins.2004.02.004\n\n\nPrsa M, Galiñanes GL, Huber D. 2017. Rapid Integration of\nArtificial Sensory Feedback during Operant\nConditioning of Motor Cortex Neurons.\nNeuron 93:929–939.e6. doi:10.1016/j.neuron.2017.01.023\n\n\nRackauckas C, Nie Q. 2017. DifferentialEquations.jl A\nPerformant and Feature-Rich Ecosystem for\nSolving Differential Equations in Julia.\nJournal of Open Research Software 5:15. doi:10.5334/jors.151\n\n\nRajalingham R, Piccato A, Jazayeri M. 2022. Recurrent neural networks\nwith explicit representation of dynamic latent variables can mimic\nbehavioral patterns in a physical inference task. Nature\nCommunications 13:1–15. doi:10.1038/s41467-022-33581-6\n\n\nRonzitti E, Conti R, Zampini V, Tanese D, Foust AJ, Klapoetke N, Boyden\nES, Papagiakoumou E, Emiliani V. 2017. Submillisecond Optogenetic\nControl of Neuronal Firing with Two-Photon\nHolographic Photoactivation of Chronos. Journal\nof Neuroscience 37:10679–10689. doi:10.1523/JNEUROSCI.1246-17.2017\n\n\nRoth BL. 2016. DREADDs for Neuroscientists.\nNeuron 89:683–694. doi:10.1016/j.neuron.2016.01.040\n\n\nRule ME, Vargas-Irwin C, Donoghue JP, Truccolo W. 2018. Phase\nreorganization leads to transient β-LFP spatial\nwave patterns in motor cortex during steady-state movement preparation.\nJournal of Neurophysiology 119:2212–2228.\ndoi:10.1152/jn.00525.2017\n\n\nSaleem AB, Lien AD, Krumin M, Haider B, Rosón MR, Ayaz A, Reinhold K,\nBusse L, Carandini M, Harris KD, Carandini M. 2017. Subcortical\nSource and Modulation of the Narrowband\nGamma Oscillation in Mouse Visual Cortex.\nNeuron 93:315–322. doi:10.1016/j.neuron.2016.12.028\n\n\nSani OG, Abbaspourazad H, Wong YT, Pesaran B, Shanechi MM. 2021a.\nModeling behaviorally relevant neural dynamics enabled by preferential\nsubspace identification. Nature Neuroscience\n24:140–149. doi:10.1038/s41593-020-00733-0\n\n\nSani OG, Pesaran B, Shanechi MM, Hsieh M. 2021b. Where is all the\nnonlinearity: Flexible nonlinear modeling of behaviorally relevant\nneural dynamics using recurrent neural networks. bioRxiv\n2021.09.03.458628. doi:10.1101/2021.09.03.458628\n\n\nSani OG, Yang Y, Lee MB, Dawes HE, Chang EF, Shanechi MM. 2018. Mood\nvariations decoded from multi-site intracranial human brain activity.\nNature Biotechnology 36:954–961. doi:10.1038/nbt.4200\n\n\nSanthanam G, Yu BM, Gilja V, Ryu SI, Afshar A, Sahani M, Shenoy KV.\n2009. Factor-Analysis Methods for Higher-Performance\nNeural Prostheses. Journal of Neurophysiology\n102:1315–1330. doi:10.1152/jn.00097.2009\n\n\nSaran S, Gupta N, Roy S. 2018. Theoretical analysis of low-power fast\noptogenetic control of firing of Chronos-expressing neurons.\nNeurophotonics 5:1. doi:10.1117/1.nph.5.2.025009\n\n\nSato TK, Nauhaus I, Carandini M. 2012. Traveling Waves in\nVisual Cortex. Neuron 75:218–229.\ndoi:10.1016/j.neuron.2012.06.029\n\n\nScheffer LK, Xu CS, Januszewski M, Lu Z, Takemura S, Hayworth KJ, Huang\nGB, Shinomiya K, Maitlin-Shepard J, Berg S, Clements J, Hubbard PM, Katz\nWT, Umayam L, Zhao T, Ackerman D, Blakely T, Bogovic J, Dolafi T,\nKainmueller D, Kawase T, Khairy KA, Leavitt L, Li PH, Lindsey L,\nNeubarth N, Olbris DJ, Otsuna H, Trautman ET, Ito M, Bates AS, Goldammer\nJ, Wolff T, Svirskas R, Schlegel P, Neace E, Knecht CJ, Alvarado CX,\nBailey DA, Ballinger S, Borycz JA, Canino BS, Cheatham N, Cook M, Dreher\nM, Duclos O, Eubanks B, Fairbanks K, Finley S, Forknall N, Francis A,\nHopkins GP, Joyce EM, Kim S, Kirk NA, Kovalyak J, Lauchie SA, Lohff A,\nMaldonado C, Manley EA, McLin S, Mooney C, Ndama M, Ogundeyi O, Okeoma\nN, Ordish C, Padilla N, Patrick CM, Paterson T, Phillips EE, Phillips\nEM, Rampally N, Ribeiro C, Robertson MK, Rymer JT, Ryan SM, Sammons M,\nScott AK, Scott AL, Shinomiya A, Smith C, Smith K, Smith NL, Sobeski MA,\nSuleiman A, Swift J, Takemura S, Talebi I, Tarnogorska D, Tenshaw E,\nTokhi T, Walsh JJ, Yang T, Horne JA, Li F, Parekh R, Rivlin PK,\nJayaraman V, Costa M, Jefferis GS, Ito K, Saalfeld S, George R,\nMeinertzhagen IA, Rubin GM, Hess HF, Jain V, Plaza SM. 2020. A\nconnectome and analysis of the adult Drosophila central\nbrain. eLife 9:e57443. doi:10.7554/eLife.57443\n\n\nSchneider S, Lee JH, Mathis MW. 2022. Learnable latent embeddings for\njoint behavioral and neural analysis. doi:10.48550/arXiv.2204.00673\n\n\nSharp AA, O’Neil MB, Abbott LF, Marder E. 1993. The dynamic clamp:\nArtificial conductances in biological neurons. Trends in\nNeurosciences 16:389–394. doi:10.1016/0166-2236(93)90004-6\n\n\nShenoy KV, Kao JC. 2021. Measurement, manipulation and modeling of\nbrain-wide neural population dynamics. Nature Communications\n12:1–5. doi:10.1038/s41467-020-20371-1\n\n\nShenoy KV, Sahani M, Churchland MM. 2013. Cortical Control\nof Arm Movements: A Dynamical Systems\nPerspective. Annual Review of Neuroscience\n36:337–359. doi:10.1146/annurev-neuro-062111-150509\n\n\nSiegle JH, López AC, Patel YA, Abramov K, Ohayon S, Voigts J. 2017. Open\nEphys: An open-source, plugin-based platform for\nmultichannel electrophysiology. Journal of Neural Engineering\n14:045003. doi:10.1088/1741-2552/aa5eea\n\n\nSmith JTH, Linderman SW, Sussillo D. 2021. Reverse engineering recurrent\nneural networks with Jacobian switching linear dynamical\nsystemsAdvances in Neural Information Processing\nSystems. pp. 16700–16713.\n\n\nSporns O. 2018. Graph theory methods: Applications in brain networks.\nDialogues in Clinical Neuroscience 20:111–121.\ndoi:10.31887/DCNS.2018.20.2/osporns\n\n\nSridharan S, Gajowa MA, Ogando MB, Jagadisan UK, Abdeladim L, Sadahiro\nM, Bounds HA, Hendricks WD, Turney TS, Tayler I, Gopakumar K, Oldenburg\nIA, Brohawn SG, Adesnik H. 2022. High-performance microbial opsins for\nspatially and temporally precise perturbations of large neuronal\nnetworks. Neuron 110:1139–1155.e6. doi:10.1016/j.neuron.2022.01.008\n\n\nSrinivasan SS, Maimon BE, Diaz M, Song H, Herr HM. 2018. Closed-loop\nfunctional optogenetic stimulation. Nature Communications\n9:1–10. doi:10.1038/s41467-018-07721-w\n\n\nSteinmetz NA, Aydin C, Lebedeva A, Okun M, Pachitariu M, Bauza M, Beau\nM, Bhagat J, Böhm C, Broux M, Chen S, Colonell J, Gardner RJ, Karsh B,\nKloosterman F, Kostadinov D, Mora-Lopez C, O’Callaghan J, Park J,\nPutzeys J, Sauerbrei B, van Daal RJJ, Vollan AZ, Wang S, Welkenhuysen M,\nYe Z, Dudman JT, Dutta B, Hantman AW, Harris KD, Lee AK, Moser EI,\nO’Keefe J, Renart A, Svoboda K, Häusser M, Haesler S, Carandini M,\nHarris TD. 2021. Neuropixels 2.0: A miniaturized\nhigh-density probe for stable, long-term brain recordings.\nScience 372. doi:10.1126/science.abf4588\n\n\nStimberg M, Brette R, Goodman DFM. 2019. Brian 2, an intuitive and\nefficient neural simulator. eLife 8. doi:10.7554/eLife.47314\n\n\nStujenske JM, Spellman T, Gordon JA. 2015. Modeling the\nSpatiotemporal Dynamics of Light and\nHeat Propagation for InVivo Optogenetics.\nCell Reports 12:525–534. doi:10.1016/j.celrep.2015.06.036\n\n\nSussillo D. 2014. Neural circuits as computational dynamical systems.\nCurrent Opinion in Neurobiology, Theoretical and computational\nneuroscience 25:156–163. doi:10.1016/j.conb.2014.01.008\n\n\nSussillo D, Barak O. 2013. Opening the Black Box:\nLow-Dimensional Dynamics in High-Dimensional\nRecurrent Neural Networks. Neural Computation\n25:626–649. doi:10.1162/NECO_a_00409\n\n\nSvoboda K, Yasuda R. 2006. Principles of Two-Photon Excitation\nMicroscopy and Its Applications to\nNeuroscience. Neuron 50:823–839.\ndoi:10.1016/j.neuron.2006.05.019\n\n\nTafazoli S, MacDowell CJ, Che Z, Letai KC, Steinhardt CR, Buschman TJ.\n2020. Learning to control the brain through adaptive closed-loop\npatterned stimulation. Journal of Neural Engineering\n17:056007. doi:10.1088/1741-2552/abb860\n\n\nTal I, Neymotin S, Bickel S, Lakatos P, Schroeder CE. 2020. Oscillatory\nBursting as a Mechanism for Temporal\nCoupling and Information Coding. Frontiers in\nComputational Neuroscience 14.\n\n\nTelenczuk B, Telenczuk M, Destexhe A. 2020. A kernel-based method to\ncalculate local field potentials from networks of spiking neurons.\nJournal of Neuroscience Methods 344:108871.\ndoi:10.1016/j.jneumeth.2020.108871\n\n\nThornton C, Hutchings F, Kaiser M. 2019. The virtual electrode recording\ntool for extracellular potentials (VERTEX)\nVersion 2.0: Modelling in vitro electrical\nstimulation of brain tissue. Wellcome Open Research\n4. doi:10.12688/wellcomeopenres.15058.1\n\n\nTomsett RJ, Ainsworth M, Thiele A, Sanayei M, Chen X, Gieselmann MA,\nWhittington MA, Cunningham MO, Kaiser M. 2015. Virtual Electrode\nRecording Tool for EXtracellular potentials\n(VERTEX): Comparing multi-electrode recordings from\nsimulated and biological mammalian cortical tissue. Brain Structure\nand Function 220:2333–2353. doi:10.1007/s00429-014-0793-x\n\n\nVaidya AR, Pujara MS, Petrides M, Murray EA, Fellows LK. 2019. Lesion\nStudies in Contemporary Neuroscience.\nTrends in Cognitive Sciences 23:653–671.\ndoi:10.1016/j.tics.2019.05.009\n\n\nVierock J, Rodriguez-Rozada S, Dieter A, Pieper F, Sims R, Tenedini F,\nBergs ACF, Bendifallah I, Zhou F, Zeitzschel N, Ahlbeck J, Augustin S,\nSauter K, Papagiakoumou E, Gottschalk A, Soba P, Emiliani V, Engel AK,\nHegemann P, Wiegert JS. 2021. BiPOLES is an optogenetic\ntool developed for bidirectional dual-color control of neurons.\nNature Communications 12:1–20. doi:10.1038/s41467-021-24759-5\n\n\nVo-Dinh T. 2003. Biomedical Photonics:\nHandbook, Biomedical Photonics: Handbook. CRC\nPress. doi:10.1001/archfaci.3.3.207\n\n\nVyas S, Golub MD, Sussillo D, Shenoy KV. 2020. Computation through\nNeural Population Dynamics. Annual Review of\nNeuroscience 43:249–275. doi:10.1146/annurev-neuro-092619-094115\n\n\nWagenaar DA, Madhavan R, Pine J, Potter SM. 2005. Controlling bursting\nin cortical cultures with closed-loop multi-electrode stimulation.\nJournal of Neuroscience 25:680–688. doi:10.1523/JNEUROSCI.4209-04.2005\n\n\nWang G, Wyskiel DR, Yang W, Wang Y, Milbern LC, Lalanne T, Jiang X, Shen\nY, Sun QQ, Zhu JJ. 2015. An optogenetics- and imaging-assisted\nsimultaneous multiple patch-clamp recording system for decoding complex\nneural circuits. Nature Protocols 10:397–412.\ndoi:10.1038/nprot.2015.019\n\n\nWang L, Huang K, Zhong C, Wang L, Lu Y. 2018. Fabrication and\nmodification of implantable optrode arrays for in vivo optogenetic\napplications. Biophysics Reports 4:82–93.\ndoi:10.1007/s41048-018-0052-4\n\n\nWang X-J, Buzsáki G. 1996. Gamma oscillation by synaptic inhibition in a\nhippocampal interneuronal network model. Journal of\nneuroscience 16:6402–6413.\n\n\nWang Y, Boyd S. 2010. Fast Model Predictive Control Using Online\nOptimization. IEEE TRANSACTIONS ON CONTROL SYSTEMS\nTECHNOLOGY 18:267. doi:10.1109/TCST.2009.2017934\n\n\nWelkenhuysen M, Hoffman L, Luo Z, De Proft A, Van den Haute C,\nBaekelandt V, Debyser Z, Gielen G, Puers R, Braeken D. 2016. An\nintegrated multi-electrode-optrode array for in vitro optogenetics.\nScientific Reports 6:20353. doi:10.1038/srep20353\n\n\nWiegert JS, Mahn M, Prigge M, Printz Y, Yizhar O. 2017. Silencing\nNeurons: Tools, Applications, and\nExperimental Constraints. Neuron\n95:504–529. doi:10.1016/j.neuron.2017.06.050\n\n\nWillett FR, Avansino DT, Hochberg LR, Henderson JM, Shenoy KV. 2021.\nHigh-performance brain-to-text communication via handwriting.\nNature 593:249–254. doi:10.1038/s41586-021-03506-2\n\n\nWilmes KA, Clopath C. 2019. Inhibitory microcircuits for top-down\nplasticity of sensory representations. Nature Communications\n10:5055. doi:10.1038/s41467-019-12972-2\n\n\nWitt A, Palmigiano A, Neef A, El Hady A, Wolf F, Battaglia D. 2013.\nControlling the oscillation phase through precisely timed closed-loop\noptogenetic stimulation: A computational study. Frontiers in Neural\nCircuits 7:1–17. doi:10.3389/fncir.2013.00049\n\n\nWu J, Liang Y, Chen S, Hsu CL, Chavarha M, Evans SW, Shi D, Lin MZ, Tsia\nKK, Ji N. 2020. Kilohertz two-photon fluorescence microscopy imaging of\nneural activity in vivo. Nature Methods\n17:287–290. doi:10.1038/s41592-020-0762-7\n\n\nYang GR, Joglekar MR, Song HF, Newsome WT, Wang X-J. 2019. Task\nrepresentations in neural networks trained to perform many cognitive\ntasks. Nature Neuroscience 22:297–306. doi:10.1038/s41593-018-0310-2\n\n\nYang Y, Qiao S, Sani OG, Sedillo JI, Ferrentino B, Pesaran B, Shanechi\nMM. 2021. Modelling and prediction of the dynamic responses of\nlarge-scale brain networks during direct electrical stimulation.\nNature Biomedical Engineering 5:324–345.\ndoi:10.1038/s41551-020-00666-w\n\n\nYizhar O, Fenno LE, Davidson TJ, Mogri M, Deisseroth K. 2011.\nOptogenetics in Neural Systems. Neuron\n71:9–34. doi:10.1016/j.neuron.2011.06.004\n\n\nZeng H. 2022. What is a cell type and how to define it? Cell\n185:2739–2755. doi:10.1016/j.cell.2022.06.031\n\n\nZenke F, Vogels TP. 2021. The Remarkable Robustness of\nSurrogate Gradient Learning for Instilling Complex\nFunction in Spiking Neural Networks. Neural\nComputation 33:899–925. doi:10.1162/neco_a_01367\n\n\nZhang L, Lee J, Rozell C, Singer AC. 2019. Sub-second dynamics of\ntheta-gamma coupling in hippocampal CA1. eLife\n8. doi:10.7554/eLife.44320\n\n\nZhang Z, Russell LE, Packer AM, Gauld OM, Häusser M. 2018. Closed-loop\nall-optical interrogation of neural circuits in vivo. Nature\nMethods 15:1037–1040. doi:10.1038/s41592-018-0183-z"
  }
]